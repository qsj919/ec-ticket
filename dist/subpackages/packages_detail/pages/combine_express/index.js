"use strict";(wx.webpackJsonp=wx.webpackJsonp||[]).push([[5644],{30849:function(e,n,i){var t=i(32180),a=i(33661),s=i(12742),o=i(22700),c=i(95333),r=i(14175),d=i(3701),u=i(92954),l=i.n(u),p=i(67294),m=i(71515),_=i(49181),x=i(59132),h=i(29748),f=i(65941),C=i(63056),y=i(91629),v=i(6420),g=i(67190),Z=i(53934),b=i(19806),j=i(23279),w=i.n(j),k="index-module__container___k0JwN",N="index-module__title___cSOlj",V="index-module__sub_title___hYX5t",T="index-module__inputs___WmNaR",I="index-module__input___ArY8y",S="index-module__input__input___jkMV5",B="index-module__input__company___pG38T",M="index-module__input__caret___D44Kh",P="index-module__input__loading___YkeWB",A="index-module__tips___M58m1",J="index-module__button___jNdMc",O="index-module__express_company___MrfIO",L="index-module__icon___V3pWZ",W=i(85893),Y=function(e){(0,c.Z)(i,e);var n=(0,r.Z)(i);function i(){var e;(0,a.Z)(this,i);for(var t=arguments.length,s=new Array(t),c=0;c<t;c++)s[c]=arguments[c];return e=n.call.apply(n,[this].concat(s)),(0,d.Z)((0,o.Z)(e),"config",{navigationBarTitleText:"关联快递"}),(0,d.Z)((0,o.Z)(e),"state",{number:"",companies:[],isCompanyVisible:!1,activeCompany:null,findingCompany:!1,foundCompany:!1}),(0,d.Z)((0,o.Z)(e),"onNumberInput",(function(n){e.setState({number:n.detail.value}),e.findProvider()})),(0,d.Z)((0,o.Z)(e),"findProvider",w()((function(){var n=e.state,i=n.activeCompany,t=n.companies,a=n.number;i||""===a.trim()||e.setState({findingCompany:!0},(function(){(0,h.oK)(a).then((function(n){var i=n.data,a=t.find((function(e){return e.id===i.id}))||null;e.setState({findingCompany:!1,foundCompany:!!a,activeCompany:a})})).catch((function(){e.setState({findingCompany:!1})}))}))}),300)),(0,d.Z)((0,o.Z)(e),"onBtnClick",(function(){var n,i=e.state,t=i.number,a=i.activeCompany,s=(0,v.JU)(null===(n=l().getCurrentInstance)||void 0===n?void 0:n.call(l()));return t?a?(l().showLoading(),void(0,h.qk)(t,a.id,s).then((function(){var e=s.sn,n=s.epid,i=s.pk;C.Z.showToast("关联成功"),l().eventCenter.trigger("logisNoChange"),y.Z.redirectTo({url:"/subpackages/packages_detail/pages/express_track/index?number=".concat(t,"&providerId=").concat(a.id,"&sn=").concat(e,"&epid=").concat(n,"&pk=").concat(i,"&from=combine")}),l().hideLoading()})).catch((function(){l().hideLoading()}))):C.Z.showToast("请选择快递公司"):C.Z.showToast("请输入快递单号")})),(0,d.Z)((0,o.Z)(e),"showCompany",(function(){e.state.findingCompany||e.setState({isCompanyVisible:!0})})),(0,d.Z)((0,o.Z)(e),"hideCompany",(function(){e.setState({isCompanyVisible:!1})})),(0,d.Z)((0,o.Z)(e),"onCompanyClick",(function(n){e.setState({activeCompany:n}),e.hideCompany()})),(0,d.Z)((0,o.Z)(e),"renderInputs",(function(){var n=e.state,i=n.number,t=n.activeCompany,a=n.findingCompany,s=(n.foundCompany,t?t.name:"");return(0,W.jsxs)(m.View,{className:T,children:[(0,W.jsxs)(m.View,{className:I,children:[(0,W.jsx)(m.Text,{children:(0,f.t)("express:expressNumber")}),(0,W.jsx)(m.Input,{value:i,className:S,placeholder:(0,f.t)("express:inputTip"),onInput:e.onNumberInput})]}),(0,W.jsxs)(m.View,{className:I,onClick:e.showCompany,children:[(0,W.jsx)(m.Text,{children:(0,f.t)("express:expressCompany")}),(0,W.jsx)(m.Text,{className:B,children:s}),a?(0,W.jsx)(m.View,{className:P,children:(0,W.jsx)(x.AtActivityIndicator,{})}):(0,W.jsx)(m.Image,{className:M,src:Z})]})]})})),e}return(0,s.Z)(i,[{key:"componentDidMount",value:function(){var e=this;(0,h.k7)().then((function(n){var i=n.data;e.setState({companies:i.rows})}))}},{key:"render",value:function(){var e=this,n=this.state,i=n.isCompanyVisible,t=n.companies,a=n.activeCompany,s=n.foundCompany;return(0,W.jsxs)(m.View,{className:k,children:[(0,W.jsx)(m.View,{className:N,children:(0,f.t)("express:combineExpress")}),(0,W.jsx)(m.View,{className:V,children:(0,f.t)("express:combineExpressTip")}),(0,W.jsx)(m.View,{children:this.renderInputs()}),s&&(0,W.jsx)(m.View,{className:A,children:(0,W.jsx)(m.Text,{children:"快递公司如猜测错误，请手动更改"})}),(0,W.jsx)(m.View,{className:J,children:(0,W.jsx)(_.Z,{label:(0,f.t)("confirm"),size:"large",onButtonClick:this.onBtnClick})}),(0,W.jsx)(b.Z,{visible:i,onRequestClose:this.hideCompany,children:t.map((function(n){return(0,W.jsxs)(m.View,{className:O,onClick:function(){return e.onCompanyClick(n)},children:[(0,W.jsx)(m.Text,{children:n.name}),a&&a.id===n.id&&(0,W.jsx)(m.Image,{className:L,src:g})]},n.id)}))})]})}}]),i}(p.PureComponent);Page((0,t.createPageConfig)(Y,"subpackages/packages_detail/pages/combine_express/index",{root:{cn:[]}},{}||{}))}},function(e){e.O(0,[2107,1216,8592],(function(){return n=30849,e(e.s=n);var n}));e.O()}]);