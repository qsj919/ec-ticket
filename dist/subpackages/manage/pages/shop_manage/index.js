"use strict";require("../../sub-vendors.js");(wx.webpackJsonp=wx.webpackJsonp||[]).push([[9984],{419:function(e,a,n){var s=n(32180),o=n(57543),i=n(77886),t=n(33661),c=n(12742),p=n(22700),r=n(95333),l=n(14175),d=n(3701),h=n(92954),g=n.n(h),m=n(67294),_=n(71515),u=n(75508),x=n(41115),f=n(63056),b=n(86356),I=n(15604),w=n(53252),v=n(8173),j=n(6420),A=n(35314),T=n(14067),k=n(29748),N="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAJ5JREFUWEftlDEOwjAQBHdLKl6Tr9AgpbyGF9lyAT+JlDcALwntRqBUVNhGOoHu6pN2NLc24Tx0zkcAhIEwEAZ+z4CZzQB2JMeU0q33J602YGbaQhcAp5zzpQeiB+CVS/Is6QnyaAHpBthCryQPLSf5FgAkLZKGUsq9xsTfAPidwLOEbs9wArAneWxp/XtBq0tY0/BPdgMgDISBMBAGVmXTTCGMr3SeAAAAAElFTkSuQmCC",y=n(85893),Z=function(e){return e.hot="爆款",e.special="特价",e}({}),M=function(e){return e.hot="店长推荐",e.special="福利",e}({}),S=function(e){(0,r.Z)(n,e);var a=(0,l.Z)(n);function n(){var e;(0,t.Z)(this,n);for(var s=arguments.length,c=new Array(s),r=0;r<s;r++)c[r]=arguments[r];return e=a.call.apply(a,[this].concat(c)),(0,d.Z)((0,p.Z)(e),"state",{headerImage:"",bannerLabel:"选择图片",hotText:Z.hot,specialText:Z.special}),(0,d.Z)((0,p.Z)(e),"onSetHeaderImg",(function(){g().chooseImage({count:1,success:function(a){g().showLoading({title:"上传中..."}),(0,v.Ix)(a.tempFilePaths[0]).then((function(a){var n=a.data;g().hideLoading();var s=JSON.parse(n);e.setState({headerImage:s.data.org[0]}),e.props.dispatch({type:"goodsManage/updataShopProfileInformation",payload:{mpErpId:e.props.mpErpId,coverType:1,coverUrls:s.data.org[0]}})})).catch((function(e){g().hideLoading(),A.Z.log("上传图片失败".concat(e))}))},fail:function(){g().hideLoading()}})})),(0,d.Z)((0,p.Z)(e),"initMerchantParams",(function(){g().showLoading({title:"请稍等..."}),(0,k.Kt)({mpErpId:e.props.mpErpId}).then((function(a){g().hideLoading(),e.props.dispatch({type:"goodsManage/save",payload:{merchantParams:a.data}})})).catch((function(e){g().hideLoading(),f.Z.showToast(e.errorMsg)}))})),(0,d.Z)((0,p.Z)(e),"onAuditClick",(function(){g().navigateTo({url:"/subpackages/manage/pages/merchant_params/index"})})),(0,d.Z)((0,p.Z)(e),"onWalletClick",(function(){g().navigateTo({url:"/subpackages/manage/pages/merchant_wallet/index"})})),(0,d.Z)((0,p.Z)(e),"goCloudBillAmktH5",(function(){if((0,x.di)())f.Z.showAlert("请前往商陆花线上接单或应用市场内续费","","好的");else{var a,n=(0,j.JU)(null===(a=g().getCurrentInstance)||void 0===a?void 0:a.call(g())).mktToken;g().navigateTo({url:"/subpackages/cloud_bill/pages/cloud_bill_amkt_h5/index?mktToken="+n+"&shopId="+e.props.shopId})}})),(0,d.Z)((0,p.Z)(e),"goHotManage",(0,i.Z)((0,o.Z)().mark((function a(){return(0,o.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return g().showLoading({title:"请稍等..."}),a.next=3,e.props.dispatch({type:"goodsManage/fetchManageHotGoods",payload:{pageSize:300}});case 3:g().hideLoading(),g().navigateTo({url:"/subpackages/manage/pages/shop_hot_goods/index?type=hot"});case 5:case"end":return a.stop()}}),a)})))),(0,d.Z)((0,p.Z)(e),"goShopBanner",(function(){g().navigateTo({url:"/subpackages/manage/pages/shop_home_banner/index?type=hot"})})),(0,d.Z)((0,p.Z)(e),"goSpecialManage",(0,i.Z)((0,o.Z)().mark((function a(){return(0,o.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return g().showLoading({title:"请稍等..."}),a.next=3,e.props.dispatch({type:"goodsManage/fetchManageSpecialGoods"});case 3:g().hideLoading(),g().navigateTo({url:"/subpackages/manage/pages/shop_hot_goods/index?type=special"});case 5:case"end":return a.stop()}}),a)})))),(0,d.Z)((0,p.Z)(e),"goShopInfo",(function(){var e,a=(0,j.JU)(null===(e=g().getCurrentInstance)||void 0===e?void 0:e.call(g())).mktToken;g().navigateTo({url:"/subpackages/manage/pages/store_profile/index?mktToken=".concat(a)})})),(0,d.Z)((0,p.Z)(e),"onShopViewerClick",(function(){var a,n=e.props.appName;e.props.mpErpId&&((0,x.di)()?g().navigateTo({url:"/pages/cloud_bill_landpage/index?fromScreen=manage&mpErpId="+e.props.mpErpId}):(0,I.f)(JSON.stringify({eventType:"slh"===n?"openWxMiniProgram":"launchMini",data:(a={path:"pages/cloud_bill_landpage/index?fromScreen=manage&mpErpId="+e.props.mpErpId},(0,d.Z)(a,"slh"===n?"miniprogramType":"miniProgramType",2),(0,d.Z)(a,"userName",w.Z.appUserName),a)})))})),(0,d.Z)((0,p.Z)(e),"onApplyMiniAppClick",(0,i.Z)((0,o.Z)().mark((function a(){return(0,o.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,T.Tv)({mpErpId:e.props.mpErpId});case 2:!1===a.sent.data.enableApplyIndependent?g().navigateTo({url:"/subpackages/apply_miniapp/pages/independent_abs/index"}):g().navigateTo({url:"/subpackages/apply_miniapp/pages/index/index?bizId=".concat(e.props.mpErpId,"&proType=cloudBill")});case 4:case"end":return a.stop()}}),a)})))),e}return(0,c.Z)(n,[{key:"componentDidShow",value:function(){(0,x.ZT)("店铺管理")}},{key:"UNSAFE_componentWillMount",value:function(){var e=this.props,a=e.independentType,n=e.saasProductType;0!==a&&40===n&&this.setState({hotText:M.hot,specialText:M.special})}},{key:"componentDidMount",value:function(){var e=this;g().showLoading({title:"请稍等..."}),0!==this.props.independentType&&this.initMerchantParams(),this.props.dispatch({type:"goodsManage/selelctShopProfileInformation",payload:{mpErpId:this.props.mpErpId}}).then((function(a){var n="";n=a&&a.coverUrls?a.coverUrls.includes(",")?a.coverUrls.split(",")[0]:a.coverUrls:"https://webdoc.hzecool.com/webCdn/weapp/ec-ticket/src/subpackages/manage/images/f48da862d459b5aa458c..png",console.log(a),e.setState({headerImage:n,bannerLabel:a.bannerUrls?a.bannerUrls.includes(",")?"已设置".concat(a.bannerUrls.split(",").length,"张"):"已设置1张":"选择图片"}),g().hideLoading()})).catch((function(e){g().hideLoading()}))}},{key:"render",value:function(){var e,a=this.props,n=a.bizStatus,s=a.expiredDate,o=a.shopName,i=a.shopLogo,t=a.merchantParams,c=a.saasProductType,p=(a.phone,a.shopInfo),r=(0,j.JU)(null===(e=g().getCurrentInstance)||void 0===e?void 0:e.call(g())).rolename,l=this.state,d=l.headerImage,h=l.bannerLabel,m=l.hotText,u=l.specialText;return(0,y.jsxs)(_.View,{className:"shop_manage col aic",children:[(0,x.$L)()&&1===n&&(0,y.jsxs)(_.View,{className:"shop_manage__timeLimit aic jcsb",children:[(0,y.jsxs)(_.View,{children:["云单有效期至 ",s&&s.split(" ")[0]]}),(0,y.jsx)(_.View,{className:"shop_manage__timeLimit___renewal aic jcc",onClick:this.goCloudBillAmktH5,children:"续费"})]}),(0,y.jsxs)(_.View,{className:"shop_manage__shopInfo",children:[(0,y.jsx)(_.Image,{mode:"aspectFill",src:d,className:"shop_manage__shopInfo__bg"}),(0,y.jsx)(_.View,{className:"setting_action",onClick:this.onSetHeaderImg,children:"设置门头照"}),(0,y.jsxs)(_.View,{className:"shop_manage__shopInfo__view aic jcsb",children:[(0,y.jsx)(_.Image,{src:i||b,className:"shop_manage__shopInfo__view__headImage"}),(0,y.jsx)(_.View,{className:"shop_manage__shopInfo__view__shopName",children:o}),(0,y.jsx)(_.View,{className:"shop_manage__shopInfo__view__shopSetting aic jcc",onClick:this.goShopInfo,children:"基础设置"})]})]}),0!==this.props.independentType&&(0,y.jsxs)(_.View,{className:"shop_manage__hotModel special audit_view  aic jcsb",onClick:this.onAuditClick,children:[(0,y.jsx)(_.Text,{children:"支付认证"}),(0,y.jsxs)(_.View,{className:"shop_manage__hotModel__action aic jcc",children:[(0,y.jsxs)(_.Text,{style:{color:1===t.bindFlag?"#28B275":"#E62E4D"},children:[0===t.bindFlag?"未认证":"",10===t.bindFlag?"认证中":"",1===t.bindFlag?"已认证":""]}),(0,y.jsx)(_.Image,{className:"right_icon",src:N})]})]}),1===t.bindFlag&&0!==this.props.independentType&&(0,x.$L)()&&("总经理"===r||"總經理"===r)&&(0,y.jsxs)(_.View,{className:"shop_manage__hotModel special audit_view aic jcsb",onClick:this.onWalletClick,children:[(0,y.jsx)(_.Text,{children:"钱包"}),(0,y.jsx)(_.View,{className:"shop_manage__hotModel__action aic jcc",children:(0,y.jsx)(_.Image,{className:"right_icon",src:N})})]}),(0,y.jsxs)(_.View,{className:"shop_manage__hotModel round_corner audit_view  aic jcsb",onClick:this.onApplyMiniAppClick,children:[(0,y.jsx)(_.Text,{children:"独立部署"}),(0,y.jsx)(_.Image,{className:"right_icon",src:N})]}),(0,y.jsxs)(_.Block,{children:[(0,y.jsx)(_.View,{className:"shop_manage__label",children:"活动模块"}),(0,y.jsxs)(_.View,{className:"shop_manage__hotModel border_line aic jcsb",children:[(0,y.jsx)(_.Text,{children:p.activityNames[2]||m}),(0,y.jsxs)(_.View,{className:"shop_manage__hotModel__action aic jcc",onClick:this.goHotManage,children:["+推荐",p.activityNames[2]||m,(0,y.jsx)(_.Image,{className:"right_icon",src:N})]})]}),(0,y.jsxs)(_.View,{className:"shop_manage__hotModel special  aic jcsb",onClick:this.goSpecialManage,children:[(0,y.jsx)(_.Text,{children:p.activityNames[10]||u}),(0,y.jsxs)(_.View,{className:"shop_manage__hotModel__action aic jcc",children:["+添加",p.activityNames[10]||u,(0,y.jsx)(_.Image,{className:"right_icon",src:N})]})]})]}),40===c&&(0,y.jsxs)(_.Block,{children:[(0,y.jsx)(_.View,{className:"shop_manage__label",children:"店铺装饰模块"}),(0,y.jsxs)(_.View,{className:"shop_manage__hotModel special  aic jcsb",onClick:this.goShopBanner,children:[(0,y.jsx)(_.Text,{children:"首页banner"}),(0,y.jsxs)(_.View,{className:"shop_manage__hotModel__action aic jcc",children:[h,(0,y.jsx)(_.Image,{className:"right_icon",src:N})]})]})]})]})}}]),n}(m.Component),C=(0,u.$j)((function(e){var a=e.goodsManage,n=e.shop,s=e.user,o=n.list.find((function(e){return e.id===a.mpErpId})),i=a.bizShops.find((function(e){return e.bizShopId==a.shopId})),t=i&&i.bizStatus?i.bizStatus:1;return{expiredDate:i&&i.subscribe.expiredDate,bizStatus:t,shopId:a.shopId,mpErpId:a.mpErpId,shopLogo:a.shopLogoUrl,shopName:a.shopName,appName:a.appName,merchantParams:a.merchantParams,independentType:a.independentType,shop:o,saasProductType:a.saasProductType,shopInfo:a.shopInfo,phone:s.phone}}))(S);Page((0,s.createPageConfig)(C,"subpackages/manage/pages/shop_manage/index",{root:{cn:[]}},{navigationBarTitleText:"店铺管理"}||{}))}},function(e){e.O(0,[2107,1216,8592],(function(){return a=419,e(e.s=a);var a}));e.O()}]);