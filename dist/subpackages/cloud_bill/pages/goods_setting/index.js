"use strict";require("../../sub-vendors.js");(wx.webpackJsonp=wx.webpackJsonp||[]).push([[2079],{15043:function(e,t,a){var n=a(32180),i=a(66058),s=a(18453),o=a(57543),r=a(77886),c=a(33661),l=a(12742),u=a(22700),p=a(95333),d=a(14175),h=a(3701),m=a(67294),w=a(75508),f=a(71515),S=a(92954),g=a.n(S),x=a(67190),v=a(67045),y=a(63056),I=a(1695),Z=a(41115),_=a(14067),k=a(6420),C=a(35314),V=a(86889),b=a(39331),P=a(52352),T=a(96999),j=a(77447),M=a(22181),N=a(85893),A=[{label:"货品",value:0},{label:"客户",value:1},{label:"订单",value:2},{label:"库存",value:3}],B=[{title:"无库存自动下架",desc:"",value:"2"},{title:"无库存不自动下架",desc:"",value:"1"}],L=[{label:"按扩展单位1换算系数",value:"1"},{label:"按扩展单位2换算系数",value:"2"}],O=[{label:"本门店库存",value:"0"},{label:"帐套内所有门店库存",value:"1"}],E=function(e){(0,p.Z)(a,e);var t=(0,d.Z)(a);function a(e){var n;return(0,c.Z)(this,a),n=t.call(this,e),(0,h.Z)((0,u.Z)(n),"componentDidMount",(0,r.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g().showLoading({title:"请稍等..."}),e.next=3,n.props.dispatch({type:"goodsManage/batchSelectAllShopParams"});case 3:return n.userManageInit(),n.orderInit(),e.next=7,n.init();case 7:n.inventoryInit(),g().hideLoading();case 9:case"end":return e.stop()}}),e)})))),(0,h.Z)((0,u.Z)(n),"init",(0,r.Z)((0,o.Z)().mark((function e(){var t,a,i,s,r,c,l,u,p,d,h;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=B.findIndex((function(e){return e.value===n.props.marketInvStrategy})))&&n.setState({checkedIndex:t}),e.next=4,Promise.all([n.props.dispatch({type:"goodsManage/selectShopParamSpuShowInv"}),n.props.dispatch({type:"goodsManage/selectShopProtectDays"}),n.props.dispatch({type:"goodsManage/selectShopPriceTypeList"}),n.props.dispatch({type:"goodsManage/selectMarketShopIsolate"}),n.props.dispatch({type:"goodsManage/selectMarketInvSource"}),n.props.dispatch({type:"goodsManage/selectShopGroupBuyVal"}),n.props.dispatch({type:"goodsManage/selectShopHotSale"})]);case 4:if(40!==n.props.saasProductType){e.next=8;break}return e.next=7,(0,_.G)({mpErpId:n.props.mpErpId});case 7:a=e.sent;case 8:i=n.props,s=i.spuShowPrice,r=i.marketInvStrategy,c=i.shopProtectDays,l=i.priceTypeList,u=i.shopDefaulPriceType,p=i.shopIsolate,d=i.groupBuy,h=i.hotSaleFlag,n.state.switchMenu.map((function(e,t){e.value===c&&n.onMenuClick(t)})),n.setState({swtichGroupBuy:"1"===d,switchPrice:"1"===s,switchStock:"0"!==r,days:c,switchBtn:c>0,hotSwitchBtn:Number(h)>0,switchShopIsolate:"1"===p,rulesValue:a&&0!==a.data.val?"".concat(a.data.val||""):"",switchOrderRules:a&&0!==a.data.val&&""!=="".concat(a.data.val),selectPriceType:l[l.findIndex((function(e){return e.sid===u}))]});case 11:case"end":return e.stop()}}),e)})))),(0,h.Z)((0,u.Z)(n),"userManageInit",(0,r.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.dispatch({type:"goodsManage/selestShopParamVisitorAuth"});case 2:return e.next=4,n.props.dispatch({type:"goodsManage/selectUserType",payload:{mpErpId:n.props.mpErpId}}).then((function(){n.initType();var e=n.state.menu;0==n.props.rule?(n.setState((function(e){return e.menu[0].use="全部客户可见",{menu:(0,s.Z)(e.menu)}})),e.length>1&&n.setState((function(e){return e.menu.pop(),{menu:(0,s.Z)(e.menu)}}))):1==n.props.rule?n.setState((function(e){return e.menu[0].use="部分客户可见",{menu:(0,s.Z)(e.menu)}})):n.setState((function(e){return e.menu[0].use="部分客户不可见",{menu:(0,s.Z)(e.menu)}})),n.setState({typeList:n.props.userList,ruleNum:n.props.rule,switchVisitorAuth:"1"===n.props.shopVisitorAuth,switchStaffViewClientPhone:"1"===n.props.allowStaffViewClientPhone})}));case 4:case"end":return e.stop()}}),e)})))),(0,h.Z)((0,u.Z)(n),"orderInit",(0,r.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("new"!==(0,k.JU)(null===(t=g().getCurrentInstance)||void 0===t?void 0:t.call(g())).type){e.next=3;break}return e.next=3,n.props.dispatch({type:"goodsManage/selectShopParamAutoAuditOrder"});case 3:n.props.dispatch({type:"cloudBill/selectAuditBillList",payload:{mpErpId:n.props.mpErpId,auditFlag:1,pageNo:1}}),n.setState({switchAutoAuditOrder:"1"===n.props.autoAuditOrder,switchOrderPay:"1"===n.props.orderPay});case 5:case"end":return e.stop()}}),e)})))),(0,h.Z)((0,u.Z)(n),"inventoryInit",(0,r.Z)((0,o.Z)().mark((function e(){var t,a,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.props,a=t.shopShowSpu,i=t.shopShowSoldOut,n.setState({switchSpu:"1"===a,switchSoldOut:"1"===i});case 2:case"end":return e.stop()}}),e)})))),(0,h.Z)((0,u.Z)(n),"onRangeItemClick",(function(e){var t=n.state.menu;if(0==e.rule&&2==t.length&&n.setState((function(e){return e.menu.pop(),{menu:(0,s.Z)(e.menu)}})),e.rule>0&&1==t.length){var a=n.props.userList.filter((function(e){return"1"==e.flag})).map((function(e){return e.name})).join("、");n.setState((function(e){return e.menu.push({text:"可见客户类型",use:a||"请选择",icon:T}),{menu:(0,s.Z)(e.menu)}}))}-1!=e.rule&&(n.setState((function(t){return t.menu[0].use=e.text,{menu:(0,s.Z)(t.menu)}})),n.props.dispatch({type:"goodsManage/selectUserType",payload:{mpErpId:n.props.mpErpId}})),n.setState({ruleNum:-1==e.rule?n.state.ruleNum:e.rule}),n.setState({userRangeShow:!1})})),(0,h.Z)((0,u.Z)(n),"initType",(function(){var e=n.props.userList,t=n.state.menu,a=e.filter((function(e){return"1"==e.flag}));t.length>1&&a.length>0&&n.setState((function(e){return e.menu[1].use=a.map((function(e){return e.name})).join("、"),{menu:(0,s.Z)(e.menu)}}))})),(0,h.Z)((0,u.Z)(n),"onTypeItemClick",(function(e,t){if(-1!==t&&-2!==t||(n.setState({typeList:e}),n.setState({userTypeRangeShow:!1})),-2===t){var a=e.filter((function(e){return"1"===e.flag}));if(n.setState((function(e){return e.menu[1].use=a.map((function(e){return e.name})).join("、"),{menu:(0,s.Z)(e.menu)}})),0==a.length)return void n.setState((function(e){return e.menu[1].use="请选择",{menu:(0,s.Z)(e.menu)}}))}})),(0,h.Z)((0,u.Z)(n),"onCenterItemClick",(function(e){0!=e?n.setState({userTypeRangeShow:!0}):n.setState({userRangeShow:!0})})),(0,h.Z)((0,u.Z)(n),"onSwitchChange",(function(e){e.detail.value?n.onMenuClick(0):(n.clearSwitchStatu(),n.setState({days:0})),n.setState({switchBtn:e.detail.value})})),(0,h.Z)((0,u.Z)(n),"onHotSwitchChange",(function(e){n.setState({hotSwitchBtn:e.detail.value})})),(0,h.Z)((0,u.Z)(n),"onOrderRulesChange",(function(e){n.setState({switchOrderRules:e.detail.value})})),(0,h.Z)((0,u.Z)(n),"onRulesClick",(function(){g().showActionSheet({itemList:L.map((function(e){return e.label})),success:function(e){n.setState({rulesValue:L[e.tapIndex].value})},fail:function(){n.setState({rulesValue:""})}})})),(0,h.Z)((0,u.Z)(n),"getRulesValue",(function(){var e=L.find((function(e){return e.value===n.state.rulesValue}));return e?e.label:"请选择"})),(0,h.Z)((0,u.Z)(n),"onMenuClick",(function(e){n.clearSwitchStatu(),n.setState((function(t){var a=t.switchMenu.map((function(t,a){return(0,i.Z)((0,i.Z)({},t),{},{flag:e===a})}));return{days:t.switchMenu[e].value,switchBtn:!0,switchMenu:(0,s.Z)(a)}}))})),(0,h.Z)((0,u.Z)(n),"clearSwitchStatu",(function(){n.setState((function(e){var t=e.switchMenu.map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{flag:!1})}));return{switchMenu:(0,s.Z)(t)}}))})),(0,h.Z)((0,u.Z)(n),"setDay",(function(e){var t=parseInt(e.detail.value||0);t>0?n.setState({days:t,switchBtn:t>0}):(n.setState({days:0}),y.Z.showToast("请输入天数"));var a=!1;n.state.switchMenu.forEach((function(e,i){e.value===t&&(n.onMenuClick(i),a=!0)})),a||n.clearSwitchStatu()})),(0,h.Z)((0,u.Z)(n),"onOptionsClick",(function(e){var t=e.currentTarget.dataset.index;n.setState({checkedIndex:t}),n.props.dispatch({type:"goodsManage/setShopGoodsMarketStrategy",payload:{value:B[t].value}})})),(0,h.Z)((0,u.Z)(n),"getMenu",(function(){var e=n.state,t=e.switchPrice,a=e.selectPriceType;return[{label:"价格设置",menuItems:[{title:"展示价格",explain:"开启后客户可以看到商品价格",defaultValue:t,func:n.onPriceSwitchChange,mode:P.I.switch,id:"0"},{title:"价格展示类型",explain:"未设置适用价的客户看到的价格",defaultValue:a&&a.name||"请选择",func:n.onSelectClick,mode:P.I.selectBox,id:"1"}]}]})),(0,h.Z)((0,u.Z)(n),"getStockMenu",(function(){var e=n.state,t=e.switchSpu,a=e.switchSoldOut,i=e.switchStock,s=e.marketInvSourceVisible,o=n.props.marketInvSource,r={title:"库存来源",explain:"选择云单库存来源",defaultValue:O.find((function(e){return e.value===(o||"0")})).label,func:n.onMarketInvSourceChange,mode:P.I.selectBox,id:"3"},c=[{label:"库存设置",menuItems:[{title:"展示库存",explain:"开启后客户可以看到商品库存",defaultValue:t,func:n.onSpuSwitchChange,mode:P.I.switch,id:"2"},{title:"展示售罄",explain:"无库存的商品显示为售罄且不可下单",defaultValue:a,func:n.onSoldOutSwitchChange,mode:P.I.switch,id:"3"}]},{label:"上下架规则",menuItems:[{title:"库存影响上下架",explain:"开启后为正的库存才会上架",defaultValue:i,func:n.onStockSwitchChange,mode:P.I.switch,id:"4"}]}];return s&&c[0].menuItems.push(r),c})),(0,h.Z)((0,u.Z)(n),"onPriceSwitchChange",(function(e){n.setState({switchPrice:e.detail.value})})),(0,h.Z)((0,u.Z)(n),"onSelectClick",(function(){n.setState({priceTypeIsShow:!0}),g().showActionSheet({itemList:n.getPriceTypeList()}).then((function(e){n.setState({priceTypeIsShow:!1,selectPriceType:n.props.priceTypeList.filter((function(e){return"1"===e.delflag}))[e.tapIndex]})})).catch((function(e){n.setState({priceTypeIsShow:!1}),console.log(e,"goods_setting")}))})),(0,h.Z)((0,u.Z)(n),"getPriceTypeList",(function(){var e=n.props.priceTypeList,t=[];return e.filter((function(e){return"1"===e.delflag})).forEach((function(e){t.push(e.name)})),t})),(0,h.Z)((0,u.Z)(n),"onSpuSwitchChange",(function(e){n.setState({switchSpu:e.detail.value})})),(0,h.Z)((0,u.Z)(n),"onSoldOutSwitchChange",(function(e){n.setState({switchSoldOut:e.detail.value})})),(0,h.Z)((0,u.Z)(n),"onStockSwitchChange",(function(e){n.setState({switchStock:e.detail.value}),e.detail.value||n.props.dispatch({type:"goodsManage/setShopGoodsMarketStrategy",payload:{value:0}})})),(0,h.Z)((0,u.Z)(n),"onVisitorAuthClick",(function(e){n.setState({switchVisitorAuth:e.detail.value}),"1"===n.props.tradeComponentStatus&&e.detail.value&&g().showModal({confirmText:"仍要开启",confirmColor:V.Z.themeColor,content:"您已开启视频号直播功能，若开启访客认证会影响直播效果，请谨慎选择"}).then((function(e){console.log(e,"res"),e.cancel&&n.setState({switchVisitorAuth:!1})}))})),(0,h.Z)((0,u.Z)(n),"onStaffViewClientPhoneClick",(function(e){n.setState({switchStaffViewClientPhone:e.detail.value})})),(0,h.Z)((0,u.Z)(n),"onAutoAuditOrderChange",(function(e){n.setAuditOrderChange(e.detail.value)})),(0,h.Z)((0,u.Z)(n),"onMarketInvSourceChange",(function(e){g().showActionSheet({itemList:O.map((function(e){return e.label}))}).then((function(e){if(e.tapIndex>-1){g().showLoading();var t=O[e.tapIndex].value;n.props.dispatch({type:"goodsManage/updateMarketInvSource",payload:{value:t}}).then((function(){g().hideLoading()})).catch((function(){g().hideLoading()}))}}))})),(0,h.Z)((0,u.Z)(n),"setAuditOrderChange",(function(e,t){n.setState({switchAutoAuditOrder:e}),e&&n.props.orderBillListBeConfirmed.length>0?y.Z.showAlert("您还有来自云单的订单未确认，请前往订单模块内处理云单订单，处理后可开启自动确认","提示","去处理",(function(){g().redirectTo({url:"/subpackages/cloud_bill/pages/order_bill_screen/index"})})):(n.setShopParam("auto_audit_order",e?"1":"0"),t&&n.setShopParam("order_pay","1"))})),(0,h.Z)((0,u.Z)(n),"onPayChange",(function(e){n.setState({switchOrderPay:e.detail.value}),e.detail.value?n.state.switchAutoAuditOrder?n.setShopParam("order_pay","1"):y.Z.showAlert("开启在线支付参数必须要开启自动确认订单参数","提示","好的",(function(){n.setAuditOrderChange(!0,!0)})):n.setShopParam("order_pay","0")})),(0,h.Z)((0,u.Z)(n),"onGroupBuyChange",(function(e){n.setState({swtichGroupBuy:e.detail.value}),n.setShopParam("order_by_group",e.detail.value?"1":"0")})),(0,h.Z)((0,u.Z)(n),"setShopParam",(function(e,t){n.props.dispatch({type:"goodsManage/updateShopParamVal",payload:{code:e,val:t}}).catch((function(){var a={order_by_group:"swtichGroupBuy",order_pay:"switchOrderPay"}[e];a&&n.setState((0,h.Z)({},a,"1"!==t))}))})),(0,h.Z)((0,u.Z)(n),"submitBtnClick",(0,r.Z)((0,o.Z)().mark((function e(){var t,a,i,s,r,c,l,u,p,d,h,m,w,f,S,x,v;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.state,i=a.switchPrice,s=a.switchSpu,r=a.switchSoldOut,c=a.switchStock,l=a.days,u=a.selectPriceType,p=a.typeList,d=a.ruleNum,a.switchAutoAuditOrder,h=a.switchShopIsolate,m=a.switchVisitorAuth,w=a.switchStaffViewClientPhone,f=a.rulesValue,S=a.switchOrderRules,x=a.hotSwitchBtn,g().showLoading({title:"请稍等..."}),0!=d){e.next=6;break}n.props.dispatch({type:"goodsManage/updateUserType",payload:{mpErpId:n.props.mpErpId,rule:d}}),e.next=14;break;case 6:if(0!=(v=p.filter((function(e){return"1"===e.flag}))).length){e.next=13;break}return g().showToast({title:"请选择",icon:"none",duration:2e3}),g().hideLoading(),e.abrupt("return");case 13:n.props.dispatch({type:"goodsManage/updateUserType",payload:{mpErpId:n.props.mpErpId,rule:d,val:v.map((function(e){return e.sid})).join(",")}});case 14:if(!i){e.next=23;break}if(!u){e.next=20;break}return e.next=18,n.props.dispatch({type:"goodsManage/updateShopParamVal",payload:{code:"spu_default_price_type",val:u.sid}});case 18:e.next=23;break;case 20:return g().showToast({title:"请选择价格展示类型",icon:"none",duration:2e3}),g().hideLoading(),e.abrupt("return");case 23:if(-1===n.state.checkedIndex&&c){e.next=28;break}return e.next=26,n.props.dispatch({type:"goodsManage/setShopGoodsMarketStrategy",payload:{value:c?B[n.state.checkedIndex].value:0}});case 26:e.next=31;break;case 28:return g().showToast({title:"请选择下架规则",icon:"none",duration:2e3}),g().hideLoading(),e.abrupt("return");case 31:if(40!==n.props.saasProductType){e.next=39;break}if(!S||!f){e.next=37;break}return e.next=35,(0,_.dg)({mpErpId:n.props.mpErpId,value:f});case 35:e.next=39;break;case 37:return e.next=39,(0,_.dg)({mpErpId:n.props.mpErpId,value:0});case 39:return n.props.dispatch({type:"goodsManage/updateShopParamVal",payload:{code:"spu_show_price",val:i?"1":"0"}}),n.props.dispatch({type:"goodsManage/updateMarketShopIsolate",payload:{value:h?"1":"0"}}),n.props.dispatch({type:"goodsManage/updateShopParamVal",payload:{code:"allow_staff_view_client_phone",val:w?"1":"0"}}),e.next=44,n.props.dispatch({type:"goodsManage/updateShopParamVal",payload:{code:"visitor_auth",val:m?"1":"0"}});case 44:return e.next=46,n.props.dispatch({type:"goodsManage/updateShopParamVal",payload:{code:"spu_show_inv",val:s?"1":"0"}});case 46:return e.next=48,n.props.dispatch({type:"goodsManage/updateShopParamVal",payload:{code:"spu_show_sold_out",val:r?"1":"0"}});case 48:return e.next=50,n.props.dispatch({type:"goodsManage/updateShopProtectDays",payload:{pubDelayDay:l}});case 50:return e.next=52,n.props.dispatch({type:"goodsManage/updateShopParamVal",payload:{code:"system_recommend_hot_spu",val:x?"1":"0"}});case 52:"new"===(0,k.JU)(null===(t=g().getCurrentInstance)||void 0===t?void 0:t.call(g())).type?n.onGoodsShelves():(g().hideLoading(),g().navigateBack());case 53:case"end":return e.stop()}}),e)})))),(0,h.Z)((0,u.Z)(n),"onTabClick",(function(e){var t;"normal"===(0,k.JU)(null===(t=g().getCurrentInstance)||void 0===t?void 0:t.call(g())).type&&n.setState({activeTabIndex:e})})),(0,h.Z)((0,u.Z)(n),"onGoodsShelves",(function(){g().showLoading({title:"请稍等..."});var e=n.props.mpErpId;(0,_.Ev)({mpErpId:e}).then((function(t){var a=t.code;g().hideLoading(),0===a&&(0,_.SR)({mpErpId:e}).then((function(e){var t=e.data;g().hideLoading();var a=Number(t.val);0===a?y.Z.showAlert("可能原因：货品没有图片，不满足库存、新款保护要求等\n您可以手动上架","没有符合条件的货品","好的",(function(){g().eventCenter.trigger("IS_NEED_GUIDE"),g().redirectTo({url:"/subpackages/cloud_bill/pages/goods_manage/index"})})):a>0&&a<100?y.Z.showAlert("即将为您上架".concat(t.val,"个货品"),"","好的",(function(){g().eventCenter.trigger("IS_NEED_GUIDE"),g().redirectTo({url:"/subpackages/cloud_bill/pages/goods_manage/index"})})):a>100&&y.Z.showAlert("即将为您上架".concat(t.val,"个货品\n货品较多，需要花费几秒的时间"),"","好的",(function(){g().eventCenter.trigger("IS_NEED_GUIDE"),g().redirectTo({url:"/subpackages/cloud_bill/pages/goods_manage/index"})}))})).catch((function(e){g().hideLoading()}))})).catch((function(e){g().hideLoading(),C.Z.log("新用户一键上架失败".concat(e))}))})),(0,h.Z)((0,u.Z)(n),"onNextClick",(function(){if(3===n.state.activeTabIndex)n.submitBtnClick();else{if(0===n.state.activeTabIndex&&!n.state.selectPriceType&&n.state.switchPrice)return void g().showToast({title:"请选择价格展示类型",icon:"none",duration:2e3});n.setState((function(e){return{activeTabIndex:e.activeTabIndex+1}}))}})),(0,h.Z)((0,u.Z)(n),"onPreClick",(function(){n.setState((function(e){return{activeTabIndex:e.activeTabIndex-1}}))})),(0,h.Z)((0,u.Z)(n),"renderActionView",(function(){var e=n.state.activeTabIndex;return(0,N.jsx)(f.View,{className:"action_view",children:0===e?(0,N.jsx)(f.View,{className:"action_view__next",onClick:n.onNextClick,children:"下一步"}):(0,N.jsxs)(f.View,{className:"action_view__pre",children:[(0,N.jsx)(f.View,{className:"action_view__pre___left",onClick:n.onPreClick,children:"上一步"}),(0,N.jsx)(f.View,{className:"action_view__pre___right",onClick:n.onNextClick,children:3===e?"完成设置，一键上架":"下一步"})]})})})),(0,h.Z)((0,u.Z)(n),"onShopIsolteClick",(function(e){n.setState({switchShopIsolate:e.detail.value})})),n.state={switchPrice:!1,switchSpu:!1,switchSoldOut:!1,switchStock:!1,switchAutoAuditOrder:!1,switchOrderPay:!1,swtichGroupBuy:!1,priceTypeIsShow:!1,switchShopIsolate:!1,switchVisitorAuth:!1,switchOrderRules:!1,checkedIndex:0,activeTabIndex:0,switchStaffViewClientPhone:!0,rulesValue:"",switchMenu:[{flag:!1,value:3},{flag:!1,value:5},{flag:!1,value:7},{flag:!1,value:10}],switchBtn:!1,hotSwitchBtn:!1,days:0,selectPriceType:{},userRangeShow:!1,userTypeRangeShow:!1,ruleNum:-1,typeList:[],menu:[{text:"新款、爆款可见范围",use:"全部客户可见",icon:T},{text:"可见客户类型",use:"无",icon:T}],marketInvSourceVisible:e.enableApplyIndependent},n}return(0,l.Z)(a,[{key:"componentDidShow",value:function(){(0,Z.ZT)("基础设置")}},{key:"render",value:function(){var e,t=this,a=this.getMenu(),n=this.getStockMenu(),i=this.state,s=i.checkedIndex,o=i.switchStock,r=i.switchMenu,c=i.switchPrice,l=i.switchBtn,u=i.hotSwitchBtn,p=i.days,d=i.activeTabIndex,h=i.userRangeShow,m=i.userTypeRangeShow,w=i.menu,S=i.typeList,y=i.switchAutoAuditOrder,Z=i.priceTypeIsShow,_=i.switchShopIsolate,C=i.switchVisitorAuth,V=i.switchOrderPay,T=i.swtichGroupBuy,L=i.switchStaffViewClientPhone,O=i.switchOrderRules,E=this.props,D=E.staffInfo,R=E.saasProductType,G=(0,k.JU)(null===(e=g().getCurrentInstance)||void 0===e?void 0:e.call(g())).type;return(0,N.jsxs)(f.View,{className:"moneyShow_wrap",children:[(0,N.jsx)(f.View,{className:"tabsView",children:(0,N.jsx)(I.Z,{data:A,activeIndex:d,underlineColor:"#E62E4D",textColor:"#222",activeColor:"#E62E4D",onTabItemClick:this.onTabClick,margin:115})}),0===d&&(0,N.jsxs)(f.View,{children:[a.map((function(e){return(0,N.jsxs)(f.View,{children:[(0,N.jsx)(f.View,{className:"label",children:e.label}),e.menuItems.map((function(e){return("1"!==e.id||"1"===e.id&&c)&&(0,N.jsx)(b.Z,{title:e.title,explain:e.explain,defaultValue:e.defaultValue,onItemClick:e.func,mode:e.mode},e.mode)}))]},e.label)})),(0,N.jsx)(f.View,{className:"label",children:"自动上下架"}),(0,N.jsx)(b.Z,{title:"门店隔离",explain:"开启后仅自动上架当前门店的货品",defaultValue:_,onItemClick:this.onShopIsolteClick,mode:P.I.switch}),(0,N.jsx)(b.Z,{title:"新款保护",explain:"开启后新款不自动上架",defaultValue:l,onItemClick:this.onSwitchChange,mode:P.I.switch}),(0,N.jsxs)(f.View,{className:"protection_wrap_center ".concat(l?"protection_wrap_centerY":"protection_wrap_centerN"),children:[(0,N.jsxs)(f.View,{style:{borderTop:"0.5px solid #f7f7f7"},className:"protection_wrap_center_item",children:[(0,N.jsx)(f.Text,{children:"新款保护时间"}),(0,N.jsxs)(f.View,{className:"protection_wrap_center_item_inputView",children:[(0,N.jsx)(f.Input,{className:"protection_wrap_center_item_inputView_input",type:"number",placeholder:"请输入天数",value:0===p?"":p+"",onInput:this.setDay}),"天"]})]}),(0,N.jsx)(f.View,{className:"protection_wrap_center_switchItems",children:(0,N.jsx)(f.View,{className:"protection_wrap_center_switchItems_switchTab",children:r.map((function(e,a){return(0,N.jsx)(f.View,{className:"protection_wrap_center_switchItems_switchTab_item ".concat(e.flag?"chooseItemY":"chooseItemN"),onClick:function(){t.onMenuClick(a)},children:(0,N.jsxs)(f.Text,{children:[e.value,"天"]})},e.value)}))})})]}),40===R&&(0,N.jsxs)(f.Block,{children:[(0,N.jsx)(f.View,{className:"label",children:"下单设置"}),(0,N.jsx)(b.Z,{title:"下单规则",explain:"开启后可设置基础单位下单规则",defaultValue:O,mode:P.I.switch,onItemClick:this.onOrderRulesChange}),O&&(0,N.jsx)(b.Z,{title:"选择规则",explain:"基础单位下单试用数量",defaultValue:this.getRulesValue(),mode:P.I.selectBox,onItemClick:this.onRulesClick})]}),(0,N.jsx)(f.View,{className:"label",children:"推荐设置"}),(0,N.jsx)(b.Z,{title:"爆款系统推荐",explain:"开启后系统将自动推送爆款商品",defaultValue:u,onItemClick:this.onHotSwitchChange,mode:P.I.switch})]}),1===d&&(0,N.jsxs)(f.View,{className:"user_manage_wrap",children:[(0,N.jsx)(f.View,{className:"label",children:"货品可见范围管理"}),(0,N.jsx)(f.View,{className:"user_manage_wrap_center",children:w.map((function(e,a){return(0,N.jsxs)(f.View,{className:"user_manage_wrap_center_item",onClick:t.onCenterItemClick.bind(t,a),children:[(0,N.jsx)(f.Text,{className:"item_one",children:e.text}),(0,N.jsxs)(f.View,{style:{display:"flex",alignItems:"center"},children:[(0,N.jsx)(f.Text,{className:"item_two",children:e.use}),(0,N.jsx)(f.Image,{className:"item_image",src:e.icon})]})]},a)}))}),(0,N.jsx)(f.View,{className:"user_manage_wrap_title",children:'前往"商陆花-往来管理"中，给客户设置类别'}),(0,N.jsx)(b.Z,{title:"访客认证",explain:"开启后，新客户需要审核才可看到您的云单",defaultValue:C,onItemClick:this.onVisitorAuthClick,mode:P.I.switch}),("总经理"===D.rolename||"總經理"===D.rolename)&&(0,N.jsx)(b.Z,{title:"允许店员查看客户手机号",explain:"开启后，店员可在客户详情看到手机号",defaultValue:L,onItemClick:this.onStaffViewClientPhoneClick,mode:P.I.switch}),(h||m)&&(0,N.jsx)(f.View,{className:"user_manage_wrap_mask",children:(0,N.jsxs)(f.View,{className:"user_manage_wrap_mask_list",children:[h&&(0,N.jsx)(j.Z,{onRangeItemClick:this.onRangeItemClick}),m&&(0,N.jsx)(M.Z,{typeList:S,onTypeItemClick:this.onTypeItemClick})]})})]}),2===d&&(0,N.jsxs)(f.View,{children:[(0,N.jsx)(b.Z,{title:"自动确认订单",explain:"开启后云单的订单将在商陆花内自动创建                ",defaultValue:y,onItemClick:this.onAutoAuditOrderChange,mode:P.I.switch,switchDisable:V}),(0,N.jsx)(b.Z,{title:"订单需在线支付",explain:"开启后云单的订单都需要在线支付                ",defaultValue:V,onItemClick:this.onPayChange,mode:P.I.switch}),(0,N.jsx)(b.Z,{title:"按手开单",explain:"童装商家适用                ",defaultValue:T,onItemClick:this.onGroupBuyChange,mode:P.I.switch})]}),3===d&&(0,N.jsxs)(f.View,{children:[n.map((function(e){return(0,N.jsxs)(f.View,{children:[(0,N.jsx)(f.View,{className:"label",children:e.label}),e.menuItems.map((function(e){return("1"!==e.id||"1"===e.id&&c)&&(0,N.jsx)(b.Z,{title:e.title,explain:e.explain,defaultValue:e.defaultValue,onItemClick:e.func,mode:e.mode},e.mode)}))]},e.label)})),(0,N.jsx)(f.View,{className:"rule ".concat(o?"ruleY":"ruleN"),children:B.map((function(e,a){return(0,N.jsxs)(f.View,{className:"rule__item","data-index":a,onClick:t.onOptionsClick,children:[(0,N.jsxs)(f.View,{children:[(0,N.jsx)(f.View,{className:"rule__item__title",children:e.title}),(0,N.jsx)(f.View,{className:"rule__item__desc",children:e.desc})]}),(0,N.jsx)(f.Image,{src:Number(a)===Number(s)?x:v,className:"rule__item__check_icon"})]},e.title)}))})]}),"normal"===G?(0,N.jsx)(f.Block,{children:!Z&&!h&&!m&&(0,N.jsx)(f.View,{className:"moneyShow_wrap_save",onClick:this.submitBtnClick,children:"保存"})}):(0,N.jsx)(f.Block,{children:this.renderActionView()})]})}}]),a}(m.PureComponent),D=(0,w.$j)((function(e){var t=e.goodsManage,a=e.cloudBill;return{groupBuy:t.groupBuy,spuShowPrice:t.spuShowPrice,shopShowSpu:t.shopShowSpu,shopShowSoldOut:t.shopShowSoldOut,marketInvStrategy:t.marketInvStrategy,autoAuditOrder:t.autoAuditOrder,orderPay:t.orderPay,shopProtectDays:t.shopProtectDays,hotSaleFlag:t.hotSaleFlag,priceTypeList:t.priceTypeList,shopDefaulPriceType:t.shopDefaulPriceType,shopVisitorAuth:t.shopVisitorAuth,userList:t.userList,rule:t.rule,mpErpId:t.mpErpId,orderBillListBeConfirmed:a.orderBillListBeConfirmed,shopIsolate:t.shopIsolate,marketInvSource:t.marketInvSource,tradeComponentStatus:t.tradeComponentStatus,enableApplyIndependent:t.enableApplyIndependent,allowStaffViewClientPhone:t.allowStaffViewClientPhone,staffInfo:t.staffInfo,saasProductType:t.saasProductType}}))(E);Page((0,n.createPageConfig)(D,"subpackages/cloud_bill/pages/goods_setting/index",{root:{cn:[]}},{navigationBarTitleText:"基础设置"}||{}))}},function(e){e.O(0,[666,1772,2107,1216,8592],(function(){return t=15043,e(e.s=t);var t}));e.O()}]);