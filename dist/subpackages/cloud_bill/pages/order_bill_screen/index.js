"use strict";require("../../sub-vendors.js");require("../../sub-common/ea5651c74a764b7a53f5764aba833936.js");(wx.webpackJsonp=wx.webpackJsonp||[]).push([[3505],{69357:function(e,t,i){var n=i(32180),s=i(57543),r=i(77886),a=i(33661),o=i(12742),l=i(22700),c=i(95333),d=i(14175),u=i(3701),h=i(92954),f=i.n(h),p=i(67294),m=i(75508),_=i(71515),g=i(1695),v=i(44559),y=i(41115),x=i(96486),w=i(47741),C=i(54448),N=i(85893),Z=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){var e;(0,a.Z)(this,i);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return e=t.call.apply(t,[this].concat(s)),(0,u.Z)((0,l.Z)(e),"onItemClick",(function(){e.props.onBillClick&&e.props.onBillClick(e.props.orderBill.billId,e.props.orderBill.userRemark||"",JSON.stringify(e.props.orderBill.afterSaleTypes))})),e}return(0,o.Z)(i,[{key:"render",value:function(){var e=this.props,t=e.orderBill,i=t.billId,n=t.nickName,s=t.dwName,r=t.logoUrl,a=(t.flagName,t.proTime),o=t.totalNum,l=t.totalMoney,c=t.styleImg,d=t.styleCode,u=t.styleName,h=t.slhBillNo,f=t.userRemark,p=t.payStatus,m=t.refundStatus,g=t.afterSaleTypes,v=void 0===g?[]:g,y=e.showPayStatus,x=w.M[p]||"",Z=w.N[m]||"",S=(0,C.v)(v),V=v.includes(3);return(0,N.jsxs)(_.View,{className:"order_bill_container",onClick:this.onItemClick,children:[(0,N.jsxs)(_.View,{className:"order_bill_container_header",children:[(0,N.jsxs)(_.View,{className:"nickNameView",children:[(0,N.jsx)(_.Image,{mode:"aspectFill",src:r,className:"headImage"}),(0,N.jsx)(_.Text,{className:"nickName",children:f||n}),(0,N.jsx)(_.Text,{className:"dwName",children:s&&"(".concat(s,")")})]}),(0,N.jsx)(_.Text,{className:"order_timer",children:a&&a.split(" ")[0]})]}),(0,N.jsxs)(_.View,{className:"order_bill_container_content",children:[(0,N.jsx)(_.View,{className:"goods_image_view",children:(0,N.jsx)(_.Image,{mode:"aspectFill",className:"goodsImage",src:c})}),(0,N.jsxs)(_.View,{className:"goods_information",children:[(0,N.jsx)(_.Text,{children:u}),(0,N.jsxs)(_.Text,{className:"goods_code",children:["#",d]})]})]}),(0,N.jsxs)(_.View,{className:"order_bill_container_bottom",children:[(0,N.jsxs)(_.View,{className:"container",children:[(0,N.jsx)(_.Text,{className:"bill_no",children:"".concat(h&&"批次：".concat(h))}),S&&(0,N.jsx)(_.Text,{className:V?"after_sale_close_desc":"after_sale_desc",children:S}),y&&x.length>0&&(0,N.jsx)(_.View,{className:"pay_status",children:x}),Z.length>0&&(0,N.jsx)(_.View,{className:"refund_status__".concat(m),children:Z})]}),(0,N.jsxs)(_.View,{children:[(0,N.jsxs)(_.Text,{className:"goods_count",children:[o,"件"]}),(0,N.jsxs)(_.Text,{className:"sum_money",children:["¥",l]})]})]})]},i)}}]),i}(p.PureComponent);(0,u.Z)(Z,"defaultProps",{orderBill:{},showPayStatus:!1});var S=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,o.Z)(i,[{key:"render",value:function(){var e=this,t=this.props,i=t.data,n=t.showPayStatus;return(0,N.jsx)(_.View,{className:"order_bill_list_container",children:i.map((function(t){return(0,N.jsx)(Z,{showPayStatus:n,onBillClick:e.props.onItemClick,orderBill:t},t.billId)}))})}}]),i}(p.PureComponent);(0,u.Z)(S,"defaultProps",{data:[]});var V="index-module__order_list_container___UqAHH",B="index-module__sticky_view___jQQ_a",b="index-module__search_container___mb0ma",k="index-module__select___MxeJX",j="index-module__tabs_view___nLcJW",R="index-module__swiper_list___RxA5t",T="index-module__swiper_list__wrapper___ciOyf",A="index-module__main___XKqCT",L="index-module__orders___mlcyy",O="index-module__has_label___CNOA1",I="index-module__order_label___M4OMq",P=i(94903),E=i(79262),D=i(27484),F=i.n(D),Y=i(63056),K=i(94184),M=i.n(K),U=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,o.Z)(i,[{key:"render",value:function(){var e=this.props,t=e.title,i=e.isSelected,n=e.onClick,s=e.customStyle;return(0,N.jsx)(_.View,{className:i?"filter-button_selected":"filter-button",onClick:n,style:s,children:(0,N.jsx)(_.Text,{className:"filter-button__text ".concat(i?"filter-button__text--selected":"filter-button__text--normal"),children:t})})}}]),i}(p.PureComponent);(0,u.Z)(U,"defaultProps",{isSelected:!1});var q=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;(0,a.Z)(this,i),n=t.call(this,e);var s=e.items,r=void 0===s?[]:s,o=e.wrapLines,l=void 0===o?2:o,c=r.length/3>l;return n.state={isCollapse:!1,showCollapse:c},n}return(0,o.Z)(i,[{key:"UNSAFE_componentWillReceiveProps",value:function(e,t){if(e.items!==this.props.items){var i=e.items.length/3>e.wrapLines;this.setState({showCollapse:i})}}},{key:"onItemClick",value:function(e){var t=this.props,i=t.onClick,n=t.typeValue;i&&i(n,e)}},{key:"onCollapse",value:function(){this.setState({isCollapse:!this.state.isCollapse})}},{key:"render",value:function(){var e=this,t=this.props,i=t.typeName,n=t.items,s=this.state,r=s.isCollapse,a=s.showCollapse,o=n;return a&&r&&(o=n.slice(0,3)),(0,N.jsx)(_.View,{children:o&&o.length>0&&(0,N.jsxs)(_.View,{className:"filter-tag-view",children:[(0,N.jsxs)(_.View,{className:"filter-tag-view__header",children:[(0,N.jsx)(_.Text,{className:"filter-tag-view__header__title",children:i}),a&&(0,N.jsx)(_.Image,{className:M()("filter-tag-view__header__action",(0,u.Z)({},"filter-tag-view__header__action--default",r)),src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAP1BMVEUAAAAAAACAgICqqqqAgICfn5+dnZ2YmJibm5uYmJiYmJiYmJiZmZmZmZmZmZmZmZmZmZmZmZmYmJiZmZmZmZm+JTm+AAAAFHRSTlMAAQIDBBgaKi4vNDlfZqOq7u/x8TcvbYsAAABYSURBVDjLY2AYBbQBbKz45bmFBLjwyguLiAhy4ZXn48ejAiTPzIJbBViegQGnCqg8ThVweRwqkOSxquBEloeoYEdRwIsiD1bBg6KAkZMR1UgmjtFkR2UAAIZLBLVEqEeNAAAAAElFTkSuQmCC",onClick:this.onCollapse.bind(this)})]}),(0,N.jsx)(_.View,{className:"filter-tag-view__tags",children:o.map((function(t){return(0,N.jsx)(U,{title:t.codeName,isSelected:t.isSelected,onClick:e.onItemClick.bind(e,t),customStyle:"margin-bottom: ".concat(f().pxTransform(32),"; margin-right: ").concat(f().pxTransform(20),";")},"codeValue")}))}),(0,N.jsx)(_.View,{className:"filter-tag-view__divider"})]})})}}]),i}(p.PureComponent);(0,u.Z)(q,"defaultProps",{items:[]});var J=i(16269),G=F()().format("YYYY-MM-DD"),Q=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;(0,a.Z)(this,i),n=t.call(this,e),(0,u.Z)((0,l.Z)(n),"onStartChange",(function(e){var t=n.props,i=t.onValueChanged,s=t.typeValue,r=t.endValue,a=void 0===r?"":r,o=e.detail.value;if(!o)return n.state.startTime;n.setState({startTime:o}),i(s,o,a)})),(0,u.Z)((0,l.Z)(n),"onEndChange",(function(e){var t=n.props,i=t.onValueChanged,s=t.typeValue,r=t.startValue,a=void 0===r?"":r,o=e.detail.value;if(!o)return n.state.endTime;n.setState({endTime:o}),i(s,a,o)}));var s=e.startValue,r=void 0===s?"":s,o=e.endValue,c=void 0===o?"":o;return n.state={start:r,end:c,startTime:r,endTime:c},n}return(0,o.Z)(i,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.startValue,i=void 0===t?"":t,n=e.endValue,s=void 0===n?"":n;this.setState({start:i,end:s,startTime:i,endTime:s})}},{key:"onStartValueChanged",value:function(e){var t=this.props,i=t.onValueChanged,n=t.typeValue,s=t.endValue,r=void 0===s?"":s;if(!J.Z.isNumber(e.detail.value))return this.state.start;this.setState({start:e.detail.value}),i(n,e.detail.value,r)}},{key:"onEndValueChanged",value:function(e){var t=this.props,i=t.onValueChanged,n=t.typeValue,s=t.startValue,r=void 0===s?"":s;if(!J.Z.isNumber(e.detail.value))return this.state.end;this.setState({end:e.detail.value}),i(n,r,e.detail.value)}},{key:"render",value:function(){var e=this.props,t=e.typeName,i=e.typeValue,n=e.startPlaceholder,s=e.endPlaceholder,r=this.state,a=r.start,o=r.end,l=r.startTime,c=r.endTime,d=17===i;return(0,N.jsxs)(_.View,{className:"filter-range-view",style:d?"margin-bottom: 20px":"",children:[(0,N.jsx)(_.View,{className:"filter-range-view__header",children:(0,N.jsx)(_.Text,{className:"filter-range-view__header__title",children:t})}),(0,N.jsxs)(_.View,{className:"filter-range-view__main",children:[!d&&(0,N.jsx)(_.Input,{type:"digit",className:"filter-range-view__main__input",placeholder:n,value:a,placeholderStyle:"font-size: 15px; color: #cccccc; text-align: center;",onInput:this.onStartValueChanged.bind(this)}),d&&(0,N.jsx)(_.View,{className:"filter-range-view__main__picker",children:(0,N.jsx)(_.Picker,{className:"picker",mode:"date",value:l,start:"1900-09-01",end:G,onChange:this.onStartChange,children:(0,N.jsx)(_.View,{className:l?"has_text":"text",children:l||"开始日期"})})}),(0,N.jsx)(_.View,{className:"filter-rang-view__main__divider"}),!d&&(0,N.jsx)(_.Input,{type:"digit",className:"filter-range-view__main__input",placeholder:s,value:o,disabled:d,placeholderStyle:"font-size: 15px; color: #cccccc; text-align: center;",onInput:this.onEndValueChanged.bind(this)}),d&&(0,N.jsx)(_.View,{className:"filter-range-view__main__picker",children:(0,N.jsx)(_.Picker,{className:"picker",mode:"date",value:c,start:"1900-09-01",end:G,onChange:this.onEndChange,children:(0,N.jsx)(_.View,{className:c?"has_text":"text",children:c||"结束日期"})})})]}),!d&&(0,N.jsx)(_.View,{className:"filter-tag-view__divider"})]})}}]),i}(p.PureComponent),W=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;(0,a.Z)(this,i),n=t.call(this,e);var s=e.configOptions,r=void 0===s?[]:s;return n.state={defaultOptions:r,options:(0,x.cloneDeep)(r),displayOptions:(0,x.cloneDeep)(r)},n}return(0,o.Z)(i,[{key:"UNSAFE_componentWillReceiveProps",value:function(e,t){var i=e.configOptions,n=e.updateOption;if(i!==this.props.configOptions&&0===this.state.defaultOptions.length&&this.setState({defaultOptions:i,options:(0,x.cloneDeep)(i),displayOptions:(0,x.cloneDeep)(i)}),n!==this.props.updateOption&&n){var s=(0,x.cloneDeep)(this.state.displayOptions);s.find((function(e){return e.typeValue===n.typeValue}))&&s.splice(n.position,1),n.isRemove||s.splice(n.position,0,(0,x.cloneDeep)(n)),this.setState({displayOptions:s})}}},{key:"componentDidMount",value:function(){var e=this;f().eventCenter.on("resetData",(function(){e.onReset()}))}},{key:"componentWillUnmount",value:function(){f().eventCenter.off("resetData")}},{key:"onItemClick",value:function(e,t){var i=this,n=(0,x.cloneDeep)(this.state.displayOptions),s=n.find((function(t){return t.typeValue===e}));if(s){var r,a=(0,E.Z)(s.items);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.codeValue===t.codeValue){if(o.isSelected=!t.isSelected,s.multipleSelect)break}else t.isSelected||s.multipleSelect||(o.isSelected=!1)}}catch(e){a.e(e)}finally{a.f()}this.setState({displayOptions:n},(function(){i.props.onItemChanged&&i.props.onItemChanged((0,x.cloneDeep)(s))}))}}},{key:"onRangeValueChanged",value:function(e,t,i,n){var s=(0,x.cloneDeep)(this.state.displayOptions),r=s.find((function(t){return t.typeValue===e}));if(r&&"range"===r.type){var a=r.items;a[0]=t,a[1]=i,a[4]=void 0!==n?n:-1,this.setState({displayOptions:s})}}},{key:"onInputChanged",value:function(e){var t=(0,x.cloneDeep)(this.state.displayOptions),i=t.find((function(e){return"input"===e.type}));i&&(i.items[0]=e.target.value,this.setState({displayOptions:t}))}},{key:"onClose",value:function(){this.setState({displayOptions:(0,x.cloneDeep)(this.state.options)}),this.props.onClose()}},{key:"onReset",value:function(){this.setState({displayOptions:(0,x.cloneDeep)(this.state.defaultOptions)})}},{key:"onConfirm",value:function(){var e=this.state.displayOptions[0].items;if(e[0]&&e[1]){var t=F()(e[0]),i=F()(e[1]);if(t.diff(i)>0)return void Y.Z.showToast("开始时间选择不能晚于结束时间！")}this.setState({options:(0,x.cloneDeep)(this.state.displayOptions)}),this.props.onValueChanged((0,x.cloneDeep)(this.state.displayOptions)),this.props.onClose()}},{key:"render",value:function(){var e=this,t=this.props,i=(t.isOpened,t.wrapLines),n=t.statusBarHeight,s=this.state.displayOptions;return(0,N.jsxs)(_.View,{className:"filter-view",children:[(0,N.jsx)(_.View,{className:"filter-view__content",style:n?"top: ".concat(44+n,"px"):"",children:(0,N.jsx)(_.ScrollView,{scrollY:!0,style:"height: 100%;",children:s.map((function(t,n){return"input"===t.type?(0,N.jsxs)(_.View,{className:"filter-input-view",children:[(0,N.jsx)(_.Text,{className:"filter-input-view__title",children:t.typeName}),(0,N.jsx)(_.Input,{className:"filter-input-view__input",placeholder:"请输入"+t.typeName,value:t.items[0],placeholderStyle:"font-size: 15px; color: #cccccc; text-align: center;",onInput:e.onInputChanged.bind(e)})]}):"tag"===t.type?(0,N.jsx)(q,{typeName:t.typeName,typeValue:t.typeValue,items:t.items,wrapLines:i,onClick:e.onItemClick.bind(e)},"typeValue"):(0,N.jsx)(Q,{typeName:t.typeName,typeValue:t.typeValue,startValue:t.items[0],endValue:t.items[1],startPlaceholder:t.items[2],endPlaceholder:t.items[3],buttonValue:t.items[4],onValueChanged:e.onRangeValueChanged.bind(e)},"typeValue")}))})}),(0,N.jsx)(_.View,{className:"bottom_view_wrap",children:(0,N.jsxs)(_.View,{className:"filter-view__action-button",children:[(0,N.jsx)(_.View,{className:"filter-view__action-button__reset",onClick:this.onReset.bind(this),children:(0,N.jsx)(_.Text,{className:"filter-view__action-button__reset___text",children:"重置"})}),(0,N.jsx)(_.View,{className:"filter-view__action-button__confirm",onClick:this.onConfirm.bind(this),children:(0,N.jsx)(_.Text,{className:"filter-view__action-button__confirm___text",children:"确认"})})]})})]})}}]),i}(p.PureComponent);(0,u.Z)(W,"defaultProps",{wrapLines:2});var z=W,H=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){var e;(0,a.Z)(this,i);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o)),(0,u.Z)((0,l.Z)(e),"state",{activeTabIndex:0,confrimedPageNo:1,confirmPageNo:1,voidedPageNo:1,refundPageNo:1,confirmedRefreshing:!1,confirmRefreshing:!1,voidedRefreshing:!1,refundRefreshing:!1,isFilterVisible:!1,filterOptions:[{typeValue:17,type:"input",typeName:"批次",multipleSelect:!1,items:[]}]}),(0,u.Z)((0,l.Z)(e),"searchKey",""),(0,u.Z)((0,l.Z)(e),"onGetRefreshMessage",(function(){e.setState({activeTabIndex:0}),e.fetchConfirmedList()})),(0,u.Z)((0,l.Z)(e),"onOrderAction",(function(t){var i=t.type;e.onOrderBillRefersh({currentTarget:{dataset:{key:"confirmed"}}}),e.onOrderBillRefersh({currentTarget:{dataset:{key:i}}})})),(0,u.Z)((0,l.Z)(e),"init",(0,r.Z)((0,s.Z)().mark((function t(){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:f().showLoading({title:"请稍等..."}),e.fetchConfirmedList(),e.fetchConfirmList(),e.fetchRefundList(),e.fetchVoidedList(),f().hideLoading();case 6:case"end":return t.stop()}}),t)})))),(0,u.Z)((0,l.Z)(e),"fetchConfirmedList",(function(){var t=e.state.confrimedPageNo;e.props.dispatch({type:"cloudBill/selectAuditBillList",payload:{mpErpId:e.props.mpErpId,auditFlag:1,pageNo:t,searchKey:e.searchKey}}).then((function(){e.setState({confirmedRefreshing:!1})})).catch((function(){e.setState({confirmedRefreshing:!1})}))})),(0,u.Z)((0,l.Z)(e),"fetchConfirmList",(function(){var t=e.state,i=t.confirmPageNo,n=t.filterOptions;e.props.dispatch({type:"cloudBill/selectAuditBillList",payload:{mpErpId:e.props.mpErpId,auditFlag:2,pageNo:i,searchKey:e.searchKey,slhBillNo:n[0].items[0]}}).then((function(){e.setState({confirmRefreshing:!1})})).catch((function(){e.setState({confirmRefreshing:!1})}))})),(0,u.Z)((0,l.Z)(e),"fetchRefundList",(function(){var t=e.state,i=t.refundPageNo,n=t.filterOptions;e.props.dispatch({type:"cloudBill/selectAuditBillList",payload:{mpErpId:e.props.mpErpId,type:5,pageNo:i,searchKey:e.searchKey,slhBillNo:n[0].items[0]}}).then((function(){e.setState({refundRefreshing:!1})})).catch((function(){e.setState({refundRefreshing:!1})}))})),(0,u.Z)((0,l.Z)(e),"fetchVoidedList",(function(){var t=e.state,i=t.voidedPageNo,n=t.filterOptions;e.props.dispatch({type:"cloudBill/selectAuditBillList",payload:{mpErpId:e.props.mpErpId,auditFlag:3,pageNo:i,searchKey:e.searchKey,slhBillNo:n[0].items[0]}}).then((function(){e.setState({voidedRefreshing:!1})})).catch((function(){e.setState({voidedRefreshing:!1})}))})),(0,u.Z)((0,l.Z)(e),"showFilterView",(function(){e.setState({isFilterVisible:!0})})),(0,u.Z)((0,l.Z)(e),"hideFilterView",(function(){e.setState({isFilterVisible:!1})})),(0,u.Z)((0,l.Z)(e),"onFilterValueChanged",(function(t){e.setState({filterOptions:t},(function(){e.onSearch()}))})),(0,u.Z)((0,l.Z)(e),"onTabClick",(function(t){e.setState({activeTabIndex:t},(function(){e.onSearch()}))})),(0,u.Z)((0,l.Z)(e),"onSwiperChange",(function(t){var i=t.detail;e.setState({activeTabIndex:i.current})})),(0,u.Z)((0,l.Z)(e),"onInput",(function(t){e.searchKey=t})),(0,u.Z)((0,l.Z)(e),"onClearSearch",(function(){e.searchKey="",e.onSearch()})),(0,u.Z)((0,l.Z)(e),"onSearch",(function(){var t=e.state.activeTabIndex,i="";0===t&&(i="confirmed"),1===t&&(i="confirm"),2===t&&(i="voided"),3===t&&(i="refund"),e.onOrderBillRefersh({currentTarget:{dataset:{key:i}}})})),(0,u.Z)((0,l.Z)(e),"_onBeConfirmedScrollEnd",(0,x.debounce)((function(){e.props.orderBillListBeConfirmed.length>=20*e.state.confrimedPageNo&&e.setState((function(e){return{confrimedPageNo:e.confrimedPageNo+1}}),(function(){e.fetchConfirmedList()}))}),100)),(0,u.Z)((0,l.Z)(e),"onBeConfirmedScrollEnd",(function(){e._onBeConfirmedScrollEnd()})),(0,u.Z)((0,l.Z)(e),"onOrderBillRefersh",(function(t){var i=t.currentTarget.dataset.key;"confirmed"===i&&(e.setState({confirmedRefreshing:!0}),1===e.state.confrimedPageNo?e.fetchConfirmedList():e.setState({confrimedPageNo:1},(function(){e.fetchConfirmedList()}))),"confirm"===i&&(e.setState({confirmRefreshing:!0}),1===e.state.confirmPageNo?e.fetchConfirmList():e.setState({confirmPageNo:1},(function(){e.fetchConfirmList()}))),"voided"===i&&(e.setState({voidedRefreshing:!0}),1===e.state.voidedPageNo?e.fetchVoidedList():e.setState({voidedPageNo:1},(function(){e.fetchVoidedList()}))),"refund"===i&&(e.setState({refundRefreshing:!0}),1===e.state.refundPageNo?e.fetchRefundList():e.setState({refundPageNo:1},(function(){e.fetchRefundList()})))})),(0,u.Z)((0,l.Z)(e),"_onBeConfirmScrollEnd",(0,x.debounce)((function(){console.log("onBeConfirmScrollEnd222"),e.props.orderBillListBeConfirm.length>=20*e.state.confirmPageNo&&e.setState((function(e){return{confirmPageNo:e.confirmPageNo+1}}),(function(){e.fetchConfirmList()}))}),100)),(0,u.Z)((0,l.Z)(e),"onBeConfirmScrollEnd",(0,r.Z)((0,s.Z)().mark((function t(){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("onBeConfirmScrollEnd"),e._onBeConfirmScrollEnd();case 2:case"end":return t.stop()}}),t)})))),(0,u.Z)((0,l.Z)(e),"_onVoidedScrollEnd",(0,x.debounce)((function(){e.props.orderBillListVoided.length>=20*e.state.voidedPageNo&&e.setState((function(e){return{voidedPageNo:e.voidedPageNo+1}}),(function(){e.fetchVoidedList()}))}),100)),(0,u.Z)((0,l.Z)(e),"_onRefundScrollEnd",(0,x.debounce)((function(){e.props.orderBillListRefund.length>=20*e.state.refundPageNo&&e.setState((function(e){return{refundPageNo:e.refundPageNo+1}}),(function(){e.fetchRefundList()}))}),100)),(0,u.Z)((0,l.Z)(e),"onVoidedScrollEnd",(function(){e._onVoidedScrollEnd()})),(0,u.Z)((0,l.Z)(e),"onRefundEnd",(function(){e._onRefundScrollEnd()})),(0,u.Z)((0,l.Z)(e),"onOrderBillClick",(function(t,i,n){f().showLoading({title:"查询数据中..."}),e.props.dispatch({type:"cloudBill/selectAuditBillDetail",payload:{billId:t}}).then((function(){f().hideLoading(),f().navigateTo({url:"/subpackages/cloud_bill/pages/order_bill_screen/order_bill_detail?billId=".concat(t,"&userRemark=").concat(i,"&afterSaleTypes=").concat(n)})}))})),e}return(0,o.Z)(i,[{key:"componentDidMount",value:function(){this.init(),f().eventCenter.on("ORDER_ACTION",this.onOrderAction),f().eventCenter.on(P.B.GO_CLOUD_ORDER_Bill,this.onGetRefreshMessage)}},{key:"componentWillUnmount",value:function(){f().eventCenter.off(P.B.GO_CLOUD_ORDER_Bill)}},{key:"componentDidShow",value:function(){(0,y.ZT)("云单订单")}},{key:"render",value:function(){var e=this.state,t=e.activeTabIndex,i=e.confirmedRefreshing,n=e.confirmRefreshing,s=e.voidedRefreshing,r=e.refundRefreshing,a=e.isFilterVisible,o=e.filterOptions,l=this.props,c=l.orderBillListBeConfirmed,d=l.orderBillListBeConfirm,u=l.orderBillListVoided,h=l.orderBillListRefund,f=(l.fetchConfirmedLoading,[{label:"待确认"},{label:"已确认"},{label:"已作废"}]);return 0!==this.props.independentType&&f.push({label:"售后处理"}),(0,N.jsxs)(_.View,{className:V,children:[(0,N.jsxs)(_.View,{className:B,children:[(0,N.jsx)(_.View,{className:j,children:(0,N.jsx)(g.Z,{data:f,activeIndex:t,onTabItemClick:this.onTabClick,activeColor:"#FF5050",underlineColor:"#FF5050",textColor:"#666",margin:70})}),(0,N.jsxs)(_.View,{className:b,children:[(0,N.jsx)(v.Z,{onInput:this.onInput,onClearSearchClick:this.onClearSearch,placeholder:"搜索客户名称",backgroundColor:"#fbfbfb",onSearchClick:this.onSearch,searchToken:this.searchKey}),0!==t&&(0,N.jsx)(_.View,{className:k,onClick:this.showFilterView,children:"筛选"})]}),1===t&&(0,N.jsx)(_.View,{className:I,children:"已确认的订单请前往商陆花内处理发货"})]}),(0,N.jsx)(_.View,{className:A,children:(0,N.jsxs)(_.Swiper,{current:t,onChange:this.onSwiperChange,className:R,children:[(0,N.jsx)(_.SwiperItem,{className:T,children:(0,N.jsx)(_.ScrollView,{className:L,scrollY:!0,lowerThreshold:500,showScrollbar:!1,refresherEnabled:!0,"data-key":"confirmed",refresherTriggered:i,onScrollToLower:this.onBeConfirmedScrollEnd,onRefresherRefresh:this.onOrderBillRefersh,children:(0,N.jsx)(S,{showPayStatus:!0,onItemClick:this.onOrderBillClick,data:c})})}),(0,N.jsx)(_.SwiperItem,{className:T,children:(0,N.jsx)(_.ScrollView,{className:O,scrollY:!0,lowerThreshold:500,showScrollbar:!1,refresherEnabled:!0,"data-key":"confirm",refresherTriggered:n,onScrollToLower:this.onBeConfirmScrollEnd,onRefresherRefresh:this.onOrderBillRefersh,children:(0,N.jsx)(S,{showPayStatus:!0,data:d,onItemClick:this.onOrderBillClick})})}),(0,N.jsx)(_.SwiperItem,{className:T,children:(0,N.jsx)(_.ScrollView,{className:L,scrollY:!0,lowerThreshold:500,showScrollbar:!1,refresherEnabled:!0,"data-key":"voided",refresherTriggered:s,onScrollToLower:this.onVoidedScrollEnd,onRefresherRefresh:this.onOrderBillRefersh,children:(0,N.jsx)(S,{data:u,onItemClick:this.onOrderBillClick})})}),(0,N.jsx)(_.SwiperItem,{className:T,children:(0,N.jsx)(_.ScrollView,{className:L,scrollY:!0,lowerThreshold:500,showScrollbar:!1,refresherEnabled:!0,"data-key":"refund",refresherTriggered:r,onScrollToLower:this.onRefundEnd,onRefresherRefresh:this.onOrderBillRefersh,children:(0,N.jsx)(S,{data:h,onItemClick:this.onOrderBillClick})})})]})}),(0,N.jsx)(z,{isOpened:a,onClose:this.hideFilterView,onValueChanged:this.onFilterValueChanged,configOptions:o})]})}}]),i}(p.PureComponent),X=(0,m.$j)((function(e){var t=e.cloudBill,i=e.goodsManage,n=e.loading;e.shop;return{independentType:i.independentType,orderBillListBeConfirmed:t.orderBillListBeConfirmed,orderBillListBeConfirm:t.orderBillListBeConfirm,orderBillListVoided:t.orderBillListVoided,orderBillListRefund:t.orderBillListRefund,mpErpId:i.mpErpId,fetchConfirmedLoading:n.effects["cloudBill/selectAuditBillList"]&&n.effects["cloudBill/selectAuditBillList"].loading}}))(H);Page((0,n.createPageConfig)(X,"subpackages/cloud_bill/pages/order_bill_screen/index",{root:{cn:[]}},{navigationBarTitleText:"云单订单"}||{}))}},function(e){e.O(0,[666,1772,6690,2107,1216,8592],(function(){return t=69357,e(e.s=t);var t}));e.O()}]);