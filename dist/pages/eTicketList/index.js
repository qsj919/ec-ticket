"use strict";(wx.webpackJsonp=wx.webpackJsonp||[]).push([[9903],{22491:function(e,t,i){var s=i(32180),o=i(18453),n=i(66058),a=i(33661),c=i(12742),r=i(22700),l=i(95333),d=i(14175),_=i(3701),h=i(92954),p=i.n(h),g=i(71515),u=i(67294),m=i(75508),f=i(844),w=i(94184),k=i.n(w),x=i(80170),v=i(24962),N="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEwAAABMCAMAAADwSaEZAAAAzFBMVEUAAAD+/v7////////////////////////////////////////////////////////////////////////////////////////////////////////CwsLw8PDq6ury8vLs7Ozu7u7o6Oj19fX4+Phvb2/6+vqAgIB9fX2JiYmDg4N3d3fGxsaMjIyGhoaRkZGOjo56enrZ2dn8/Pzb29uTk5Nzc3PW1tbJycmXl5fNzc1qamrExMTg4ODd3d27u7uwsLCpqamdnZ3T09NtNrrkAAAAHHRSTlMA/pH5tT4wH+/s5+Xf2dLMwax/fGdRNi0PCQb2DPv3vQAABOxJREFUWMOtmIdy2zAMhi1ZjhNnOHtV4o663GW5tZs4TZO+/zsVoUiDy6vXP+vOl/vuB0CCIDsrddM7z4ujg71ud+/gqMjPezedf9Tl6XG3VkpKSV8lpaqb7vHp5fak/tlho4BSVdSRpFJlh2f9rVA7J5kCDohaGOJknZ3sbI4qMgUcwzJAQ2r/qKzYDHedZ7JCaVTle9PR5tfrWRcDVXGP5eVNtt+genCxBnWbN5QbFtJSmQNl+e3KGg7VK0r/+ETAWYy2pnH1cEVdr/YlB2kUT3tzkCC1f7WM1dulLYsjC3lIMixN2+0tYb2hHIW4VUWV8k2SdmV8WXPcR7klxbyBdhOR9vcpC4zFK8QHwrfOW1SF26FEUirQGEVt3obhCskVZ5x5JFPWIFo/Ug2s82DdN5wx7tIiVLQ+LIvK7MLbj4OKMcDFkcZ5Qw7mbXDtBclAYMwCsQieuaC/gavWmxvoTsastqkC7lKZYUcqaAvSkSKPxakTPlBaoCoWxhrHmKGR8awsy9lUoLfH57cPDw/vnh8h2GCXUrR2IhcsxlpHk3lpNLZVeLp7aHX3u4prqk7M2s9YID4tUX9a1vMd6iURaNbugzPJiIfik9LV+NVaeefqN3VwxtqZhh1y5tPIvPQkIPHvfrT62P5+jPqbPNRnbU00CjUufU05f/roy02bNHFeAuxUEpBr7j6AzTj/+c3XJ9vfEKdOAXZcEeax2KgMxPn7d4GgJGFFj2E26RIthrwyFOFvQ4m4v3VvOj1IWWBtFMM+hEr0t6bXOdcp00DLu49hnwP9xP62UH3eyaUhYREmMex9oKe4v0mVd4rKONM4LTKKYJ98fRGpyaHoHDHLwsz9imBffc1S/U0edQ4AhsJl68O+eHpK97eDzl5LwcRp4OPIh3139HLP0yfgXqdLfGeGRib3Iwf20+rl94wsO+q7CMMaBD2Esw1Pme5rmMKjYeaEFecEpP+xxVkhT4epC4A4GyQT05nTg5iz66fEn9/oYn47gKUhFijM3GTuF8Dvlun5DZZGUQkS0bBtozNHf5InICzanAILzLnESZmGoTeewKkcNjqQfJaYhzuAxbsVcIHUObQgoUVQ4zJ2FmiamJDqHjRHQ0LcbD1slpgcujfQtrnQQtpoPazk0fwmj/WBoq05iSs3gDGDQqlTfdQJYqyJJc4SnTzeWc2lPoSZJqG36KhLnH7R/EYPzXgghJe26BCOO/k0mt/UmRlcFiRj0Q9qLqJOPicGxBf7NOubkYoKIxOn37YncSefRLOlPFkMewIVBTptG8k4FSSawzm0qBYoE++vkQ1oYvvbI37EA4GxwhmQhV8D+DOGtj26HwuNwk4OH4UzPuQMjYFyKVyRQEEnj28fKvcuFcz1JnwUCVDRhE8H1951p0ZfUX9jaA5xrrnmIryIIcvvbywYkuKrjMqjKyJFGih1YhGc793EyeFtfHnlfgUQ51tDomHt91PXaiZcWRoCkcftFyR/9yp94Uca9jckJVcIxQt/QNvlXtbE2iUCvnrLH0mcKlhvyIqLKvevVj7frEpbaE0N+6sflmrmkBCIiVsAqya/XfvkJQUKePH8ZmwNLjZ6jKtWbnpNo/gYt+6ZsKFuf4t3g2yKnW0eMCVDZ36slYQHzG2fVmvJMVQk1fi0uu2jr6QVY22uKqnq1Y++//U5+i8EmzPGCq5cewAAAABJRU5ErkJggg==",b="shopListNew-module__sln_container___e5_yb",L="shopListNew-module__sln_container_shops___aVkrl",Z="shopListNew-module__sln_container_shops__shop___OL76f",T="shopListNew-module__noLogoView___O6bZC",C="shopListNew-module__text_center___QURT3",A="shopListNew-module__noLogoText___LLSHW",V="shopListNew-module__sln_shopLogoUrl____18Zf",j="shopListNew-module__sln_shopName___kJ33r",D="shopListNew-module__all_shops_item_view___rgxUX",S="shopListNew-module__last_shop__first___shczQ",P="shopListNew-module__last_shop__second___pEAXC",I="shopListNew-module__last_shop__third___ztu0h",y="shopListNew-module__last_shop__fourth___dXr2v",M="shopListNew-module__all_shops_label___GuYGw",O=i(85893),E=function(e){(0,l.Z)(i,e);var t=(0,d.Z)(i);function i(){var e;(0,a.Z)(this,i);for(var s=arguments.length,o=new Array(s),c=0;c<s;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o)),(0,_.Z)((0,r.Z)(e),"onItemClick",(function(t){var i=e.props,s=i.onShopNameClick,o=i.shopList,n=t.currentTarget.dataset._id,a=o.findIndex((function(e){return e.id===n}));s(o[a])})),(0,_.Z)((0,r.Z)(e),"getFilterShopList",(function(t){return e.props.shopList.filter((function(e){return e.shopName.includes(t)}))})),(0,_.Z)((0,r.Z)(e),"onAllShopsClick",(function(){x.Z.track(v.ZP.allShopsClick),p().navigateTo({url:"/subpackages/ticket/pages/all_shops/index"})})),(0,_.Z)((0,r.Z)(e),"getShopList",(function(){var t=e.props.shopList,i=void 0===t?[]:t;return i.length<=10?i.map((function(e){return(0,n.Z)({},e)})):i.length>10?i.slice(0,9).map((function(e){return(0,n.Z)({},e)})):[]})),(0,_.Z)((0,r.Z)(e),"renderMoreShops",(function(){var t=e.props.shopList,i=t.slice(t.length-4);return(0,O.jsxs)(g.View,{onClick:e.onAllShopsClick,className:Z,children:[(0,O.jsxs)(g.View,{className:D,children:[(0,O.jsx)(g.Image,{src:i[0].logoUrl||N,className:S}),(0,O.jsx)(g.Image,{src:i[1].logoUrl||N,className:P}),(0,O.jsx)(g.Image,{src:i[2].logoUrl||N,className:I}),(0,O.jsx)(g.Image,{src:i[3].logoUrl||N,className:y})]}),(0,O.jsx)(g.Image,{className:M,src:"data:image/png;base64,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"})]})})),e}return(0,c.Z)(i,[{key:"render",value:function(){var e=this,t=this.props.shopList,i=this.getShopList();return(0,O.jsx)(g.View,{className:b,children:(0,O.jsx)(g.View,{style:"width:100%;height:100%;",children:(0,O.jsxs)(g.View,{className:L,children:[i.map((function(t,i){return(0,O.jsxs)(g.View,{id:0===i?"shopItem":"","data-_id":t.id,onClick:e.onItemClick,className:Z,children:[t.logoUrl?(0,O.jsx)(g.Image,{className:V,src:t.logoUrl,mode:"aspectFill"}):(0,O.jsx)(g.View,{className:k()(V,T),children:(0,O.jsx)(g.View,{className:k()(A,(0,_.Z)({},C,t.shopName.length<=3)),style:{fontSize:"17rpx"},children:(0,O.jsx)(g.Text,{style:{fontSize:"".concat(t.shopName.length<=3&&"25rpx")},children:t.shopName})})}),(0,O.jsx)(g.Text,{className:j,children:t.shopName})]},t.shopid)})),t.length>10&&this.renderMoreShops()]})})})}}]),i}(u.PureComponent);(0,_.Z)(E,"defaultProps",{activeColor:"#F2503D",size:"small",checkShopIndex:0,shopItem:{},shopList:[]});var U=i(85962),H=i(1695),F=i(29748),B=i(16269),z=i(48882),R=i(53934),K=i(6420),G=i(22381),J=function(e){(0,l.Z)(i,e);var t=(0,d.Z)(i);function i(e){var s;return(0,a.Z)(this,i),s=t.call(this,e),(0,_.Z)((0,r.Z)(s),"ob",void 0),(0,_.Z)((0,r.Z)(s),"onCheckDetailClick",(function(e){p().navigateTo({url:"/pages/eTicketDetail/landscapeModel?sn=".concat(e.sn,"&epid=").concat(e.epid,"&pk=").concat(e.billId)})})),(0,_.Z)((0,r.Z)(s),"onShopLogoClick",(function(e){var t=e.currentTarget.dataset.shop,i="epid=".concat(t.epid,"&shopid=").concat(t.shopId,"&sn=").concat(t.sn);p().navigateTo({url:"/subpackages/ticket/pages/ticket_home/index?type=1&".concat(i)})})),s.state={isDatePickerVisible:0===e.index},s}return(0,c.Z)(i,[{key:"componentDidMount",value:function(){var e=this,t=this.props.intersectionTop,i=void 0===t?0:t,s=p().getSystemInfoSync().windowHeight;this.ob=p().createIntersectionObserver(this),this.ob.relativeToViewport({bottom:-(s-i-60),top:-i}).observe(".bill_cell_new_header",(function(t){t.intersectionRatio>0?e.setState({isDatePickerVisible:!0}):0!==e.props.index&&e.setState({isDatePickerVisible:!1})}))}},{key:"componentWillUnmount",value:function(){this.ob&&this.ob.disconnect()}},{key:"render",value:function(){var e=this,t=this.props,i=t.data,s=t.dateString,o=this.state.isDatePickerVisible;return(0,O.jsxs)(g.View,{children:[(0,O.jsxs)(g.View,{className:"bill_cell_new_header",children:[(0,O.jsx)(g.Text,{className:"bill_cell_new_header__title",children:i.title}),(0,O.jsxs)(g.Text,{className:"bill_cell_new_header__sub",children:["".concat(i.total,"家门店共").concat(i.totalNum,"单  "),(0,O.jsx)(g.Text,{children:"¥"}),(0,O.jsx)(g.Text,{className:"bill_cell_new_header__sum",children:B.Z.toFixed(i.totalMoney)})]}),o&&(0,O.jsxs)(g.View,{className:"bill_cell_new_header__date",onClick:this.props.onDatePickerClick,children:[s,(0,O.jsx)(g.Image,{src:R,className:"bill_cell_new_header__date__icon"})]})]}),(0,O.jsx)(g.View,{className:"bill_cell_new_list",children:i.data.map((function(t){return(0,O.jsxs)(g.View,{className:"bill_cell_new",children:[(0,O.jsxs)(g.View,{className:"bill_cell_new__date",children:[(0,O.jsx)(g.Text,{className:"bill_cell_new__date__day",children:(0,K.DC)(t.prodate).length>2?t.day:(0,K.DC)(t.prodate)}),(0,O.jsx)(g.Text,{className:"bill_cell_new__date__month",children:(0,K.DC)(t.prodate).length>2?"".concat(t.month,"月"):""})]}),(0,O.jsx)(g.View,{className:"bill_cell_new__content",children:t.shops.map((function(t){return(0,O.jsxs)(g.View,{children:[(0,O.jsxs)(g.View,{"data-shop":t,className:"bill_cell_new__content__shop aic",onClick:e.onShopLogoClick,children:[t.shopLogo?(0,O.jsx)(g.Image,{className:"bill_cell_new__content__avatar",src:t.shopLogo||z}):(0,O.jsx)(g.View,{className:k()("bill_cell_new__content__avatar","noLogoView"),children:(0,O.jsx)(g.View,{className:k()("noLogoText",{text_center:t.shopName.length<=3}),style:{fontSize:"17rpx"},children:(0,O.jsx)(g.Text,{style:{fontSize:"".concat(t.shopName.length<=3&&"25rpx")},children:t.shopName})})}),t.shopName]}),(0,O.jsx)(g.View,{className:"bill_cell_new__content__listContent",children:t.bills.map((function(t){return(0,O.jsx)(G.Z,{item:t,onItemClick:e.onCheckDetailClick},t.billId)}))})]},t.shopId)}))})]},t.prodate)}))})]})}}]),i}(u.Component);(0,_.Z)(J,"options",{styleIsolation:"shared"}),(0,_.Z)(J,"defaultProps",{data:{data:[],totalMoney:0},intersectionTop:0,dateString:"选择时间"});var q=i(50229),Q=i(31254),X=i(65915),Y={header_bg:"eTicketList-module__header_bg___Xu4Hv",custom_container:"eTicketList-module__custom_container___huleo",navigation_view:"eTicketList-module__navigation_view___k5PQj",search_view:"eTicketList-module__search_view___eJlvv",search__icon:"eTicketList-module__search__icon___UD5A4",search_view_placeholder:"eTicketList-module__search_view_placeholder___rqTSM",shops_view:"eTicketList-module__shops_view___AOdsI",container:"eTicketList-module__container___rYu1g",container_tabs__view:"eTicketList-module__container_tabs__view___uTPXn",container__content:"eTicketList-module__container__content___q5Kqy",container__content__bills:"eTicketList-module__container__content__bills___mAk6y","container__content__bills--height":"eTicketList-module__container__content__bills--height___aVk9J",container__content__no_more:"eTicketList-module__container__content__no_more___vmYZr",empty_view:"eTicketList-module__empty_view___bQF5p",empty_view_image:"eTicketList-module__empty_view_image___ANw16",empty_view_title:"eTicketList-module__empty_view_title___jjUPL",empty_view_label:"eTicketList-module__empty_view_label___qEirT"},W=i(10162),$=[{label:"全部小票"},{label:"拿货相册"}],ee=function(e){(0,l.Z)(i,e);var t=(0,d.Z)(i);function i(e){var s;(0,a.Z)(this,i),s=t.call(this,e),(0,_.Z)((0,r.Z)(s),"pageNo",1),(0,_.Z)((0,r.Z)(s),"init",(function(){s.fetchUnionTicketList()})),(0,_.Z)((0,r.Z)(s),"onShopNameClick",(function(e){x.Z.track(v.ZP.shopClick),p().navigateTo({url:"/subpackages/ticket/pages/ticket_home/index?id=".concat(e.id,"&type=2")})})),(0,_.Z)((0,r.Z)(s),"onRefresh",(function(){0===s.state.activeIndex&&s.fetchUnionTicketList(),1===s.state.activeIndex&&s.fetchGoodsListDate({orderBy:s.state.sortType,pageNo:1}),s.props.dispatch({type:"shop/fetchShopList"})})),(0,_.Z)((0,r.Z)(s),"onScrollToLower",(function(){0===s.state.activeIndex&&(s.pageNo*Q.IV>s.state.ticketCount||s.fetchUnionTicketList(!0))})),(0,_.Z)((0,r.Z)(s),"onParentScrollToLower",(function(){if(1===s.state.activeIndex){if(s.state.goodsDataList.length>=20*s.state.goodsListPageNo){var e={orderBy:s.state.sortType,pageNo:s.state.goodsListPageNo+1};s.fetchGoodsListDate(e)}}else 0===s.state.activeIndex&&s.onScrollToLower()})),(0,_.Z)((0,r.Z)(s),"fetchUnionTicketList",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?s.pageNo+=1:s.pageNo=1,1===s.pageNo&&s.setState({refresherTriggered:!0}),(0,F.__)({pageNo:s.pageNo,prodateGte:s.state.dateStart,prodateLte:s.state.dateEnd}).then((function(e){var t=e.data;s.setState((function(e){var i=e.ticketCount;1===s.pageNo?i=t.bills.length:i+=t.bills.length;var o=(0,W.nL)(t.bills,1===s.pageNo?[]:e.ticketList);return(0,W.q0)(o,t.monthData),{ticketList:o,ticketCount:i,refresherTriggered:!1}}))})).catch((function(t){s.setState({refresherTriggered:!1}),e&&s.pageNo--}))})),(0,_.Z)((0,r.Z)(s),"onSearhViewClick",(function(){x.Z.track(v.ZP.eTicketListSearchClick),p().navigateTo({url:"/subpackages/ticket/pages/ticket_search/index?activeIndex=".concat(s.state.activeIndex)})})),(0,_.Z)((0,r.Z)(s),"onTabsClick",(function(e){0===e?x.Z.track(v.ZP.allTicketsClick):1===e&&x.Z.track(v.ZP.goodsAlbumTabClick),s.setState({activeIndex:e}),1===e&&0===s.state.goodsDataList.length&&s.fetchGoodsListDate({orderBy:s.state.sortType,pageNo:1})})),(0,_.Z)((0,r.Z)(s),"onSortTabClick",(function(e){s.setState({sortType:e},(function(){s.fetchGoodsListDate({pageNo:1})}))})),(0,_.Z)((0,r.Z)(s),"fetchGoodsListDate",(function(e){var t=s.state.sortType;1===e.pageNo&&s.setState({refresherTriggered:!0}),(0,F.Hp)((0,n.Z)((0,n.Z)({},e),{},{orderBy:t})).then((function(t){1===e.pageNo?s.setState({goodsDataList:t.data.rows,goodsListPageNo:e.pageNo,refresherTriggered:!1}):s.setState((function(i){return{goodsDataList:[].concat((0,o.Z)(i.goodsDataList),(0,o.Z)(t.data.rows)),goodsListPageNo:e.pageNo,refresherTriggered:!1}}))})).catch((function(t){p().hideLoading(),1!==e.pageNo&&s.setState((function(e){return{goodsListPageNo:e.goodsListPageNo-1,refresherTriggered:!1}})),1===e.pageNo&&s.setState({refresherTriggered:!1})}))})),(0,_.Z)((0,r.Z)(s),"onDatePickClick",(function(){x.Z.track(v.ZP.useDateClick),s.setState({isDatePickerVisible:!0})})),(0,_.Z)((0,r.Z)(s),"onDateConfirm",(function(e){s.hidePicker(),s.setState({dateStart:e.startDate,dateEnd:e.endDate},(function(){s.fetchUnionTicketList()}))})),(0,_.Z)((0,r.Z)(s),"hidePicker",(function(){s.setState({isDatePickerVisible:!1})})),(0,_.Z)((0,r.Z)(s),"goodsItemClick",(function(e){var t=s.props.shopList.find((function(t){return String(t.shopid)===String(e.shopId)&&String(t.epid)===String(e.epid)&&String(t.sn)===String(e.sn)}));s.props.dispatch({type:"imageDownload/fetchImageUrlsFormatData",payload:{mpErpId:t.id,styleIds:e.styleId,sourceData:[(0,n.Z)((0,n.Z)({},e),{},{allImgUrlBig:e.allImgUrlBig||e.imgUrl,tenantSpuId:e.styleId})]}}),x.Z.track(v.ZP.goodsClick),p().navigateTo({url:"/subpackages/functional/pages/download_image/index?".concat(s.getQuery(t))})})),(0,_.Z)((0,r.Z)(s),"onShopClick",(function(e){var t=s.props.shopList.find((function(t){return String(t.shopid)===String(e.shopId)&&String(t.epid)===String(e.epid)&&String(t.sn)===String(e.sn)}));p().navigateTo({url:"/subpackages/ticket/pages/ticket_home/index?id=".concat(t.id,"&type=2")})})),(0,_.Z)((0,r.Z)(s),"getQuery",(function(e){return"logo=".concat(e.logoUrl,"&shopName=").concat(e.shopName,"&cloudBillFlag=").concat(e.cloudBillFlag,"&epid=").concat(e.epid,"&sn=").concat(e.sn,"&mpErpId=").concat(e.id)})),(0,_.Z)((0,r.Z)(s),"renderNavigation",(function(){var e=s.props,t=e.navigationHeight,i=e.statusBarHeight,o=e.gap;return(0,O.jsxs)(g.View,{className:Y.navigation_view,style:{height:"".concat(t+i+o,"px"),paddingTop:"".concat(i,"px")},children:[(0,O.jsxs)(g.View,{className:Y.search_view,onClick:s.onSearhViewClick,children:[(0,O.jsx)(g.Image,{src:U,className:Y.search__icon}),(0,O.jsx)(g.Text,{className:Y.search_view_placeholder,children:"搜索小票、商品"})]}),(0,O.jsx)(g.Image,{className:Y.header_bg,src:"https://webdoc.hzecool.com/webCdn/weapp/ec-ticket/src/assets/images/5196e8a62ae612e96b23..png"})]})}));var c=(0,K.cm)(90),l=c.startDate,d=c.endDate;return s.state={activeIndex:0,sortType:"latestProDate",goodsDataList:[],ticketList:[],ticketCount:-1,goodsListPageNo:1,isDatePickerVisible:!1,dateStart:l,dateEnd:d,refresherTriggered:!1},s}return(0,c.Z)(i,[{key:"componentDidMount",value:function(){!this.props.isLogining&&this.props.sessionId&&this.init(),"weChatAudit"===this.props.productVersion&&p().hideTabBar()}},{key:"componentDidUpdate",value:function(e){this.props.isLogining||e.sessionId||!this.props.sessionId||this.init()}},{key:"render",value:function(){var e=this,t=this.props,i=t.shopList,s=t.navigationHeight,o=t.statusBarHeight,n=t.gap,a=this.state,c=a.activeIndex,r=a.goodsDataList,l=a.ticketList,d=a.ticketCount,h=a.isDatePickerVisible,p=a.dateStart,u=a.dateEnd,m=a.refresherTriggered,w=a.sortType;return(0,O.jsxs)(f.Z,{enableBack:!1,stickyTop:!0,containerClass:Y.custom_container,children:[this.renderNavigation(),(0,O.jsxs)(g.ScrollView,{className:Y.scroll_view,scrollY:!0,style:{height:"calc(100% - ".concat(s+o+n,"px)")},lowerThreshold:500,onScrollToLower:this.onParentScrollToLower,refresherEnabled:!0,refresherTriggered:m,onRefresherRefresh:this.onRefresh,children:[(0,O.jsx)(g.View,{className:Y.shops_view,children:(0,O.jsx)(E,{shopList:i,onShopNameClick:this.onShopNameClick})}),(0,O.jsxs)(g.View,{className:k()(Y.container,(0,_.Z)({},Y.fixed_container_height,0===c)),children:[(0,O.jsx)(g.View,{className:Y.container_tabs__view,children:(0,O.jsx)(H.Z,{data:$,onTabItemClick:this.onTabsClick,activeIndex:c,textColor:"#666",activeColor:"#222",margin:200,underlineWidth:40,underlineHeight:6,tabsBackgroundImage:"linear-gradient(to right, #FF788F, #E62E4D)"})}),(0,O.jsxs)(g.View,{className:Y.container__content,children:[0===c&&(0,O.jsxs)(g.View,{className:Y.container__content__bills,children:[l.map((function(t,i){return(0,O.jsx)(J,{dateString:p+u===""?"选择时间":"".concat(p," - ").concat(u),index:i,data:t,onDatePickerClick:e.onDatePickClick,intersectionTop:s+o+n},t.key)})),d<=0?(0,O.jsxs)(g.View,{style:{height:"100%"},children:[0===d&&(0,O.jsxs)(g.View,{className:"bill_cell_new_header",children:[(0,O.jsx)(g.Text,{className:"bill_cell_new_header__title",style:{fontSize:"36rpx"},children:"".concat(p,"至").concat(u)}),(0,O.jsxs)(g.Text,{className:"bill_cell_new_header__sub",children:["".concat(0,"家门店共",0,"单  "),(0,O.jsx)(g.Text,{children:"¥"}),(0,O.jsx)(g.Text,{className:"bill_cell_new_header__sum",children:"0"})]}),(0,O.jsxs)(g.View,{className:"bill_cell_new_header__date",onClick:this.onDatePickClick,children:["选择时间",(0,O.jsx)(g.Image,{src:R,className:"bill_cell_new_header__date__icon"})]})]}),(0,O.jsxs)(g.View,{className:Y.empty_view,children:[(0,O.jsx)(g.Image,{src:"https://webdoc.hzecool.com/webCdn/weapp/ec-ticket/src/assets/images/100496bff03d571feb01..png",className:Y.empty_view_image}),(0,O.jsx)(g.View,{className:Y.empty_view_title,children:"没有发现小票足迹"}),(0,O.jsx)(g.View,{className:Y.empty_view_label,children:"可点击顶部店铺头像查看店铺历史小票"})]})]}):this.pageNo*Q.IV>d&&-1!==d&&(0,O.jsx)(g.View,{className:Y.container__content__no_more,children:"到底啦～"})]}),1===c&&(0,O.jsx)(X.Z,{sortType:w,goodsData:r,sortTabClick:this.onSortTabClick,onItemClick:this.goodsItemClick,onShopClick:this.onShopClick})]})]})]}),(0,O.jsx)(q.Z,{visible:h,mask:!0,initDateStart:p,initDateEnd:u,onConfirmClick:this.onDateConfirm,onCancelClick:this.hidePicker,tips:"仅支持查询2021年8月后的数据",type:"0"})]})}}]),i}(u.Component),te=(0,m.$j)((function(e){var t=e.systemInfo,i=e.shop,s=e.user;return{shopList:i.list.sort((function(e,t){return e.showOrder-t.showOrder})).filter((function(e){return 2!==e.independentType})),statusBarHeight:t.statusBarHeight,navigationHeight:t.navigationHeight,gap:t.gap,isLogining:s.logining,sessionId:s.sessionId,productVersion:s.productVersion}}))(ee);Page((0,s.createPageConfig)(te,"pages/eTicketList/index",{root:{cn:[]}},{navigationStyle:"custom"}||{}))}},function(e){e.O(0,[2107,1216,8592],(function(){return t=22491,e(e.s=t);var t}));e.O()}]);